<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Deconvolution · JuChrom</title><meta name="title" content="Deconvolution · JuChrom"/><meta property="og:title" content="Deconvolution · JuChrom"/><meta property="twitter:title" content="Deconvolution · JuChrom"/><meta name="description" content="Documentation for JuChrom."/><meta property="og:description" content="Documentation for JuChrom."/><meta property="twitter:description" content="Documentation for JuChrom."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.svg" alt="JuChrom logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">JuChrom</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../man/basics/">Basics</a></li><li><a class="tocitem" href="../../man/retentionindices/">Retention Indices</a></li><li><a class="tocitem" href="../../man/massspectra/">Mass Spectra</a></li><li><a class="tocitem" href="../../man/import/">Data Import</a></li><li><a class="tocitem" href="../../man/export/">Data Export</a></li></ul></li><li><span class="tocitem">Internals</span><ul><li><a class="tocitem" href="../base/">Base</a></li><li class="is-active"><a class="tocitem" href>Deconvolution</a></li><li><a class="tocitem" href="../inputoutput/">InputOutput</a></li></ul></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../../tutorials/retentionindices/">Retention Indices</a></li></ul></li><li><a class="tocitem" href="../../man/register/">Index</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Internals</a></li><li class="is-active"><a href>Deconvolution</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Deconvolution</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/oniehuis/JuChrom.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/oniehuis/JuChrom.jl/blob/main/docs/src/internals/deconvolution.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Deconvolution"><a class="docs-heading-anchor" href="#Deconvolution">Deconvolution</a><a id="Deconvolution-1"></a><a class="docs-heading-anchor-permalink" href="#Deconvolution" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JuChrom.Deconvolution.LocalMaxima" href="#JuChrom.Deconvolution.LocalMaxima"><code>JuChrom.Deconvolution.LocalMaxima</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">JuChrom.LocalMaxima(values::AbstractVector{&lt;:Real}; 
startindex::Integer=firstindex(values), stopindex::Integer=lastindex(values))</code></pre><p>Return an iterator that yields the index range of each local maximum until no more local  maxima are found. If the maximum is a single peak, the range will have a length of 1; if a  plateau maximum is found, the range will have a length greater than 1. The optional keyword  arguments <code>startindex</code> and <code>stopindex</code> allow you to restrict the search range for the  maximum. Note that <code>startindex</code> and <code>stopindex</code> must be at least two indices apart (e.g.,  <code>startindex=1</code>, <code>stopindex=3</code>).</p><p>See also <a href="#JuChrom.Deconvolution.nextlocalmaximum"><code>nextlocalmaximum</code></a>.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; values = [4, 3, 5, 3, 6, 6, 6, 4, 7];

julia&gt; for lm in JuChrom.LocalMaxima(values); println(lm); end
3:3
5:7

julia&gt; for lm in JuChrom.LocalMaxima(values, startindex=3); println(lm); end
5:7

julia&gt; for lm in JuChrom.LocalMaxima(values, stopindex=7); println(lm); end
3:3

julia&gt; for lm in JuChrom.LocalMaxima(values, startindex=4, stopindex=8); println(lm); end
5:7

julia&gt; for lm in JuChrom.LocalMaxima(values, startindex=4, stopindex=5); println(lm); end
ERROR: ArgumentError: stopindex not greater than startindex + 1: 4 5
[...]

julia&gt; length(values)
9

julia&gt; for lm in JuChrom.LocalMaxima(values, startindex=8); println(lm); end
ERROR: ArgumentError: stopindex not greater than startindex + 1: 8 9
[...]</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/oniehuis/JuChrom.jl/blob/6d63ef5708675c473c63954e160bffcc61f8da57/src/Deconvolution/Deconvolution.jl#L48-L89">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JuChrom.Deconvolution.lsfit" href="#JuChrom.Deconvolution.lsfit"><code>JuChrom.Deconvolution.lsfit</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">JuChrom.lsfit(xs::AbstractVector{&lt;:Union{Real, Unitful.Quantity{&lt;:Real}}}, 
ys::AbstractVector{&lt;:Union{Real, Unitful.Quantity{&lt;:Real}}})</code></pre><p>Return the intercept and slope from a simple linear regression, fitting the line of best  fit (in the form <code>y = mx + b</code>) for the given data points <code>xs</code> and <code>ys</code> using the least  squares method. The function expects two arguments: a vector of x-coordinates (independent  variable), <code>xs</code>, and a vector of y-coordinates (dependent variable), <code>ys</code>. Both vectors  must have the same length and contain at least two values. The function throws an  <code>ArgumentError</code> if the lengths of <code>xs</code> and <code>ys</code> differ or if either vector contains fewer  than two values.</p><p>The function calculates the slope (<code>m</code>) and intercept (<code>b</code>) for the line of best fit using  the formulas</p><ul><li><code>m = Σ((xᵢ - x̄)(yᵢ - ȳ)) / Σ((xᵢ - x̄)²)</code></li><li><code>b = ȳ - m * x̄</code></li></ul><p>where <code>x̄</code> and <code>ȳ</code> are the means of the <code>xs</code> and <code>ys</code> vectors, respectively.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; xs, ys = [1.0, 2.0, 3.0, 4.0, 5.0], [1.0, 2.0, 3.0, 4.0, 5.0];

julia&gt; JuChrom.lsfit(xs, ys) .≈ (0.0, 1.0)
(true, true)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/oniehuis/JuChrom.jl/blob/6d63ef5708675c473c63954e160bffcc61f8da57/src/Deconvolution/Deconvolution.jl#L111-L138">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JuChrom.Deconvolution.nextlocalmaximum" href="#JuChrom.Deconvolution.nextlocalmaximum"><code>JuChrom.Deconvolution.nextlocalmaximum</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">JuChrom.nextlocalmaximum(values::AbstractVector{&lt;:Real}; 
startindex::Integer=firstindex(values), stopindex::Integer=lastindex(values))</code></pre><p>Return the index range of the next local maximum. If the maximum is a single peak, the  range will have a length of 1; if a plateau maximum is found, the range will have a  length greater than 1. If no maximum is found, nothing is returned. The optional keyword  arguments <code>startindex</code> and <code>startindex</code> allow you to restrict the search range for the  maximum. Note that <code>startindex</code> and <code>startindex</code> must be at least two indices apart (e.g.,  <code>startindex=1</code>, <code>stopindex=3</code>).</p><p>See also <a href="#JuChrom.Deconvolution.LocalMaxima"><code>LocalMaxima</code></a>.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; values = [4, 3, 5, 3, 6, 6, 6, 4, 7];

julia&gt; JuChrom.nextlocalmaximum(values)  # finds 5
3:3

julia&gt; JuChrom.nextlocalmaximum(values, startindex=4)  # finds pleateau maximum 6, 6, 6
5:7

julia&gt; JuChrom.nextlocalmaximum(values, startindex=4, stopindex=7)  # finds nothing

julia&gt; length(values)
9

julia&gt; JuChrom.nextlocalmaximum(values, startindex=8)  # implicit stopindex=9
ERROR: ArgumentError: stopindex not greater than startindex + 1: 8 9
[...]

julia&gt; JuChrom.nextlocalmaximum(values, startindex=1, stopindex=2)
ERROR: ArgumentError: stopindex not greater than startindex + 1: 1 2
[...]</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/oniehuis/JuChrom.jl/blob/6d63ef5708675c473c63954e160bffcc61f8da57/src/Deconvolution/Deconvolution.jl#L156-L192">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JuChrom.Deconvolution.stddev" href="#JuChrom.Deconvolution.stddev"><code>JuChrom.Deconvolution.stddev</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">JuChrom.stddev(chrom::AbstractChromMS; windowsize::Integer=13, threshold::Real=0,
nthreads::Integer=Threads.nthreads())::Tuple{Union{Float64, Nothing}, Int}</code></pre><p>Return an estimate of the standard deviation (σ) in the intensity measurements of the  instrument used to infer the chromatographic data by analyzing intensity fluctuations  within user-defined scan windows (default: 13 scans). The function also returns the number  of windows considered in the computation as a second output. This approach is based on the  method described by Stein (1999) for estimating noise levels in chromatographic data, with  some modifications. In brief, only windows with intensity values above the specified  threshold (default: 0) are included. Additionally, the total number of transitions must  exceed half the window&#39;s scan count, and no more than two consecutive intensity values can  fall on the same side of the mean intensity within any given window. For windows that meet  these criteria, the absolute differences between intensity values and the median intensity  are used to calculate the median absolute deviation (MAD). Since intensity fluctuations are  proportional to the square root of the measured intensity, the MAD is normalized by  dividing it by the square root of the median intensity. The MAD is calculated for all  possible non-overlapping windows across the intensity values for all ions. The median of  the MAD values is then multiplied by 1.4826 to estimate σ, assuming that the  intensity-normalized fluctuations follow a normal distribution. If no suitable windows are  found for calculating σ, the function returns (<code>nothing</code>, 0).</p><p><strong>Reference</strong></p><p>Stein SE (1999): An integrated method for spectrum extraction and compound identification  from gas chromatography/mass spectrometry data. J. Am. Soc. Mass. Spectrom. 10: 770–781.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; dfolder = joinpath(JuChrom.agilent, &quot;C7-C40_ChemStationMS.D&quot;);

julia&gt; chrom = binions(importdata(dfolder, ChemStationMS()));

julia&gt; JuChrom.stddev(chrom) .≈ (1.989116630064713, 9874)
(true, true)

julia&gt; dfolder = joinpath(JuChrom.agilent, &quot;C7-C40_MassHunterMS.D&quot;);

julia&gt; chrom = binions(importdata(dfolder, MassHunterMS()));

julia&gt; JuChrom.stddev(chrom) .≈ (1.951017182665152, 10979)
(true, true)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/oniehuis/JuChrom.jl/blob/6d63ef5708675c473c63954e160bffcc61f8da57/src/Deconvolution/Deconvolution.jl#L217-L259">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../base/">« Base</a><a class="docs-footer-nextpage" href="../inputoutput/">InputOutput »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Tuesday 12 August 2025 06:47">Tuesday 12 August 2025</span>. Using Julia version 1.11.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
