<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Mapping tools · JuChrom.jl</title><meta name="title" content="Mapping tools · JuChrom.jl"/><meta property="og:title" content="Mapping tools · JuChrom.jl"/><meta property="twitter:title" content="Mapping tools · JuChrom.jl"/><meta name="description" content="Documentation for JuChrom.jl."/><meta property="og:description" content="Documentation for JuChrom.jl."/><meta property="twitter:description" content="Documentation for JuChrom.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.svg" alt="JuChrom.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">JuChrom.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Manual</span><ul><li><input class="collapse-toggle" id="menuitem-2-1" type="checkbox"/><label class="tocitem" for="menuitem-2-1"><span class="docs-label">Core containers</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../containers/">Design overview</a></li><li><a class="tocitem" href="../scans/">Scans</a></li><li><a class="tocitem" href="../scanseries/">Scan series</a></li><li><a class="tocitem" href="../scanmatrices/">Scan matrices</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-2" type="checkbox"/><label class="tocitem" for="menuitem-2-2"><span class="docs-label">Loaders</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../loaderapi/">Loader API</a></li><li><a class="tocitem" href="../agilentfid/">Agilent FID</a></li><li><a class="tocitem" href="../chemstationms/">Agilent ChemStation MS</a></li><li><a class="tocitem" href="../masshunterms/">Agilent MassHunter MS</a></li><li><a class="tocitem" href="../shimadzums/">Shimadzu MS</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-3" type="checkbox" checked/><label class="tocitem" for="menuitem-2-3"><span class="docs-label">Data processing</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-2-3-1" type="checkbox" checked/><label class="tocitem" for="menuitem-2-3-1"><span class="docs-label">Retention mapping</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../mapping_overview/">Overview</a></li><li class="is-active"><a class="tocitem" href>Mapping tools</a><ul class="internal"><li><a class="tocitem" href="#AbstractRetentionMapper"><span>AbstractRetentionMapper</span></a></li><li><a class="tocitem" href="#RetentionMapper"><span>RetentionMapper</span></a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-3-2" type="checkbox"/><label class="tocitem" for="menuitem-2-3-2"><span class="docs-label">Binning and Gridding</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../mz_binning/">m/z binning</a></li><li><a class="tocitem" href="../binning_gridding/">Retention binning and gridding</a></li></ul></li><li><a class="tocitem" href="../alignment/">Alignment</a></li><li><a class="tocitem" href="../baseline/">Baseline</a></li><li><a class="tocitem" href="../convert/">Format conversion</a></li><li><a class="tocitem" href="../transformation/">Transformation</a></li><li><a class="tocitem" href="../transform/">Trimming and Filtering</a></li><li><a class="tocitem" href="../quadvar_model/">Variance modeling</a></li></ul></li></ul></li><li><span class="tocitem">Internals</span><ul><li><a class="tocitem" href="../../internals/transform/">Transform</a></li><li><a class="tocitem" href="../../internals/utils/">Utilities</a></li></ul></li><li><a class="tocitem" href="../register/">Index</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Manual</a></li><li><a class="is-disabled">Data processing</a></li><li><a class="is-disabled">Retention mapping</a></li><li class="is-active"><a href>Mapping tools</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Mapping tools</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/oniehuis/JuChrom.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/oniehuis/JuChrom.jl/blob/main/docs/src/man/mapping_tools.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Mapping-tools"><a class="docs-heading-anchor" href="#Mapping-tools">Mapping tools</a><a id="Mapping-tools-1"></a><a class="docs-heading-anchor-permalink" href="#Mapping-tools" title="Permalink"></a></h1><h2 id="AbstractRetentionMapper"><a class="docs-heading-anchor" href="#AbstractRetentionMapper">AbstractRetentionMapper</a><a id="AbstractRetentionMapper-1"></a><a class="docs-heading-anchor-permalink" href="#AbstractRetentionMapper" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="JuChrom.AbstractRetentionMapper"><a class="docstring-binding" href="#JuChrom.AbstractRetentionMapper"><code>JuChrom.AbstractRetentionMapper</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">AbstractRetentionMapper{A, B} &lt;: Any</code></pre><p>Abstract supertype for fitted retention-time mappings between two domains.</p><p><code>A</code> is the unit type for the input domain (<code>Unitful.Units</code> subtype or <code>Nothing</code>), and <code>B</code> is the unit type for the output domain (<code>Unitful.Units</code> subtype or <code>Nothing</code>).</p><p>Concrete subtypes are expected to define  <code>rA::AbstractVector{&lt;:Real}</code> – the raw numeric calibration data values from the input domain,  <code>rA_unit::Union{Unitful.Units, Nothing}</code> – the unit associated with the input domain,  <code>rA_min::Real</code> – the minimum predicted value of the input domain,  <code>rA_max::Real</code> – the minimum predicted value of the input domain, <code>rB::AbstractVector{&lt;:Real}</code> – the raw numeric calibration data values from the output domain, <code>rB_unit::Union{Unitful.Units, Nothing}</code> – the unit associated with the output domain,  <code>rB_min::Real</code> – the minimum predicted value of the output domain, <code>rB_max::Real</code> – the maximum predicted value of the output domain, and <code>extras::Dict{String, Any}</code> – a metadata dictionary associated with the retention mapper.</p><p>See also <a href="#JuChrom.RetentionMapper"><code>RetentionMapper</code></a>,  <a href="#JuChrom.extras-Tuple{JuChrom.AbstractRetentionMapper}"><code>extras</code></a>, <a href="#JuChrom.fitmap"><code>fitmap</code></a>, <a href="#JuChrom.invmapmax"><code>invmapmax</code></a>, <a href="#JuChrom.invmapmin"><code>invmapmin</code></a>, <a href="#JuChrom.mapmax"><code>mapmax</code></a>, <a href="#JuChrom.mapmin"><code>mapmin</code></a>, <a href="#JuChrom.rawinvmapmax"><code>rawinvmapmax</code></a>, <a href="#JuChrom.rawinvmapmin"><code>rawinvmapmin</code></a>, <a href="#JuChrom.rawmapmax"><code>rawmapmax</code></a>, <a href="#JuChrom.rawmapmin"><code>rawmapmin</code></a>. <a href="#JuChrom.rawretentions_A"><code>rawretentions_A</code></a>,  <a href="#JuChrom.rawretentions_B"><code>rawretentions_B</code></a>,  <a href="#JuChrom.retentions_A"><code>retentions_A</code></a>,  <a href="#JuChrom.retentions_B"><code>retentions_B</code></a>,  <a href="#JuChrom.retentionunit_A"><code>retentionunit_A</code></a>,  <a href="#JuChrom.retentionunit_B"><code>retentionunit_B</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/oniehuis/JuChrom.jl/blob/dae4d2fb13e7d05a1fb199b701e38bb500504479/src/core/retention_mapping/container.jl#L1-L38">source</a></section></details></article><article><details class="docstring" open="true"><summary id="JuChrom.extras-Tuple{JuChrom.AbstractRetentionMapper}"><a class="docstring-binding" href="#JuChrom.extras-Tuple{JuChrom.AbstractRetentionMapper}"><code>JuChrom.extras</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">extras(rm::AbstractRetentionMapper)</code></pre><p>Return the metadata dictionary associated with a retention mapper.</p><p>The metadata can store additional information such as calibration file name, creation date, experimental conditions, or other user-defined properties. It is a mutable dictionary and does not affect the mapping operations.</p><p>See also <a href="#JuChrom.AbstractRetentionMapper"><code>AbstractRetentionMapper</code></a>, <a href="#JuChrom.RetentionMapper"><code>RetentionMapper</code></a>, <a href="#JuChrom.fitmap"><code>fitmap</code></a>.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; retention_times = [1.2, 2.5, 4.1, 6.8, 9.3, 12.1, 15.7]u&quot;minute&quot;
       retention_indices = [100.0, 200.0, 300.0, 400.0, 500.0, 600.0, 700.0]
       mapper = fitmap(retention_times, retention_indices, 
                       extras=Dict(&quot;cal_file&quot; =&gt; &quot;test.cal&quot;, &quot;instrument&quot; =&gt; &quot;GC-MS&quot;));

julia&gt; extras(mapper)
Dict{String, Any} with 2 entries:
  &quot;cal_file&quot;   =&gt; &quot;test.cal&quot;
  &quot;instrument&quot; =&gt; &quot;GC-MS&quot;

julia&gt; extras(mapper)[&quot;cal_file&quot;]
&quot;test.cal&quot;

julia&gt; extras(mapper)[&quot;analysis_date&quot;] = &quot;2025-06-28&quot;;

julia&gt; extras(mapper)
Dict{String, Any} with 3 entries:
  &quot;cal_file&quot;      =&gt; &quot;test.cal&quot;
  &quot;instrument&quot;    =&gt; &quot;GC-MS&quot;
  &quot;analysis_date&quot; =&gt; &quot;2025-06-28&quot;</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/oniehuis/JuChrom.jl/blob/dae4d2fb13e7d05a1fb199b701e38bb500504479/src/core/retention_mapping/container.jl#L274-L311">source</a></section></details></article><article><details class="docstring" open="true"><summary id="JuChrom.invmapmin"><a class="docstring-binding" href="#JuChrom.invmapmin"><code>JuChrom.invmapmin</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">invmapmin(rm::AbstractRetentionMapper; unit::Union{Nothing, Unitful.Units}=nothing)</code></pre><p>Return the minimum predicted value of domain B.</p><p>For unitful mappers, the result carries units and can be converted with <code>unit</code>. For unitless mappers, <code>unit</code> must be <code>nothing</code>; otherwise <code>ArgumentError</code> is thrown with the message &quot;Cannot convert unitless retention B minimum to a unit&quot;.</p><p>See also <a href="#JuChrom.rawinvmapmin"><code>rawinvmapmin</code></a>, <a href="#JuChrom.invmapmax"><code>invmapmax</code></a>, <a href="#JuChrom.rawinvmapmax"><code>rawinvmapmax</code></a>,  <a href="#JuChrom.fitmap"><code>fitmap</code></a>.</p><p>See also <a href="#JuChrom.AbstractRetentionMapper"><code>AbstractRetentionMapper</code></a>,  <a href="#JuChrom.RetentionMapper"><code>RetentionMapper</code></a>, <a href="#JuChrom.applymap"><code>applymap</code></a>, <a href="#JuChrom.derivinvmap"><code>derivinvmap</code></a>, <a href="#JuChrom.derivmap"><code>derivmap</code></a>, <a href="#JuChrom.fitmap"><code>fitmap</code></a>, <a href="#JuChrom.invmap"><code>invmap</code></a>, <a href="#JuChrom.invmapmax"><code>invmapmax</code></a>, <a href="#JuChrom.mapmax"><code>mapmax</code></a>, <a href="#JuChrom.mapmin"><code>mapmin</code></a>, <a href="#JuChrom.rawapplymap"><code>rawapplymap</code></a>, <a href="#JuChrom.rawderivinvmap"><code>rawderivinvmap</code></a>, <a href="#JuChrom.rawderivmap"><code>rawderivmap</code></a>, <a href="#JuChrom.rawinvmap"><code>rawinvmap</code></a>, <a href="#JuChrom.rawinvmapmax"><code>rawinvmapmax</code></a>, <a href="#JuChrom.rawinvmapmin"><code>rawinvmapmin</code></a>, <a href="#JuChrom.rawmapmax"><code>rawmapmax</code></a>, <a href="#JuChrom.rawmapmin"><code>rawmapmin</code></a>, <a href="#JuChrom.retentionunit_A"><code>retentionunit_A</code></a>,  <a href="#JuChrom.retentionunit_B"><code>retentionunit_B</code></a>.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; retention_times = [1.2, 2.5, 4.1, 6.8, 9.3]u&quot;minute&quot;
       retention_indices = [100.0, 200.0, 300.0, 400.0, 500.0]
       mapper = fitmap(retention_times, retention_indices);

julia&gt; invmapmin(mapper) ≈ 100.00001207241763
true

julia&gt; invmapmin(mapper) ≈ applymap(mapper, mapmin(mapper))
true

julia&gt; (invmapmin(mapper), invmapmax(mapper)) .≈ (100.00001207241763, 499.9999793028839)
(true, true)

julia&gt; inputs = [1.2, 2.5, 4.1, 6.8, 9.3]
       outputs = [100.0, 200.0, 300.0, 400.0, 500.0]
       mapper_unitless = fitmap(inputs, outputs);

julia&gt; invmapmin(mapper_unitless) ≈ 100.00001207241763
true

julia&gt; invmapmin(mapper_unitless, unit=u&quot;s&quot;)
ERROR: ArgumentError: Cannot convert unitless retention A minimum to a unit</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/oniehuis/JuChrom.jl/blob/dae4d2fb13e7d05a1fb199b701e38bb500504479/src/core/retention_mapping/map.jl#L911-L970">source</a></section></details></article><article><details class="docstring" open="true"><summary id="JuChrom.invmapmax"><a class="docstring-binding" href="#JuChrom.invmapmax"><code>JuChrom.invmapmax</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">invmapmax(rm::AbstractRetentionMapper; unit::Union{Nothing, Unitful.Units}=nothing)</code></pre><p>Return the maximum predicted value of domain B.</p><p>For unitful mappers, the result carries units and can be converted with <code>unit</code>. For unitless mappers, <code>unit</code> must be <code>nothing</code>; otherwise <code>ArgumentError</code> is thrown with the message &quot;Cannot convert unitless retention B maximum to a unit&quot;.</p><p>See also <a href="#JuChrom.AbstractRetentionMapper"><code>AbstractRetentionMapper</code></a>,  <a href="#JuChrom.RetentionMapper"><code>RetentionMapper</code></a>, <a href="#JuChrom.applymap"><code>applymap</code></a>, <a href="#JuChrom.derivinvmap"><code>derivinvmap</code></a>, <a href="#JuChrom.derivmap"><code>derivmap</code></a>, <a href="#JuChrom.fitmap"><code>fitmap</code></a>, <a href="#JuChrom.invmap"><code>invmap</code></a>, <a href="#JuChrom.invmapmin"><code>invmapmin</code></a>, <a href="#JuChrom.mapmax"><code>mapmax</code></a>, <a href="#JuChrom.mapmin"><code>mapmin</code></a>, <a href="#JuChrom.rawapplymap"><code>rawapplymap</code></a>, <a href="#JuChrom.rawderivinvmap"><code>rawderivinvmap</code></a>, <a href="#JuChrom.rawderivmap"><code>rawderivmap</code></a>, <a href="#JuChrom.rawinvmap"><code>rawinvmap</code></a>, <a href="#JuChrom.rawinvmapmax"><code>rawinvmapmax</code></a>, <a href="#JuChrom.rawinvmapmin"><code>rawinvmapmin</code></a>, <a href="#JuChrom.rawmapmax"><code>rawmapmax</code></a>, <a href="#JuChrom.rawmapmin"><code>rawmapmin</code></a>, <a href="#JuChrom.retentionunit_A"><code>retentionunit_A</code></a>,  <a href="#JuChrom.retentionunit_B"><code>retentionunit_B</code></a>.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; retention_times = [1.2, 2.5, 4.1, 6.8, 9.3]u&quot;minute&quot;
       retention_indices = [100.0, 200.0, 300.0, 400.0, 500.0]
       mapper = fitmap(retention_times, retention_indices);

julia&gt; invmapmax(mapper) ≈ 499.9999793028839
true

julia&gt; invmapmax(mapper) ≈ applymap(mapper, mapmax(mapper))
true

julia&gt; invmap(mapper, invmapmax(mapper)) ≈ mapmax(mapper)
true

julia&gt; inputs = [1.2, 2.5, 4.1, 6.8, 9.3]
       outputs = [100.0, 200.0, 300.0, 400.0, 500.0]
       mapper_unitless = fitmap(inputs, outputs);

julia&gt; invmapmax(mapper_unitless) ≈ 499.9999793028839
true

julia&gt; invmapmax(mapper_unitless, unit=u&quot;s&quot;)
ERROR: ArgumentError: Cannot convert unitless retention A minimum to a unit</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/oniehuis/JuChrom.jl/blob/dae4d2fb13e7d05a1fb199b701e38bb500504479/src/core/retention_mapping/map.jl#L985-L1041">source</a></section></details></article><article><details class="docstring" open="true"><summary id="JuChrom.mapmax"><a class="docstring-binding" href="#JuChrom.mapmax"><code>JuChrom.mapmax</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">mapmax(rm::AbstractRetentionMapper; unit::Union{Nothing, Unitful.Units}=nothing)</code></pre><p>Return the maximum input value from domain A used during calibration.</p><p>For unitful mappers, the result carries units and can be converted with <code>unit</code>. For unitless mappers, <code>unit</code> must be <code>nothing</code>; otherwise <code>ArgumentError</code> is thrown with the message &quot;Cannot convert unitless retention A maximum to a unit&quot;.</p><p>See also <a href="#JuChrom.AbstractRetentionMapper"><code>AbstractRetentionMapper</code></a>,  <a href="#JuChrom.RetentionMapper"><code>RetentionMapper</code></a>, <a href="#JuChrom.applymap"><code>applymap</code></a>, <a href="#JuChrom.derivinvmap"><code>derivinvmap</code></a>, <a href="#JuChrom.derivmap"><code>derivmap</code></a>, <a href="#JuChrom.fitmap"><code>fitmap</code></a>, <a href="#JuChrom.invmap"><code>invmap</code></a>, <a href="#JuChrom.invmapmax"><code>invmapmax</code></a>, <a href="#JuChrom.invmapmin"><code>invmapmin</code></a>, <a href="#JuChrom.mapmin"><code>mapmin</code></a>, <a href="#JuChrom.rawapplymap"><code>rawapplymap</code></a>, <a href="#JuChrom.rawderivinvmap"><code>rawderivinvmap</code></a>, <a href="#JuChrom.rawderivmap"><code>rawderivmap</code></a>, <a href="#JuChrom.rawinvmap"><code>rawinvmap</code></a>, <a href="#JuChrom.rawinvmapmax"><code>rawinvmapmax</code></a>, <a href="#JuChrom.rawinvmapmin"><code>rawinvmapmin</code></a>, <a href="#JuChrom.rawmapmax"><code>rawmapmax</code></a>, <a href="#JuChrom.rawmapmin"><code>rawmapmin</code></a>, <a href="#JuChrom.retentionunit_A"><code>retentionunit_A</code></a>,  <a href="#JuChrom.retentionunit_B"><code>retentionunit_B</code></a>.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; retention_times = [1.2, 2.5, 4.1, 6.8, 9.3]u&quot;minute&quot;
       retention_indices = [100.0, 200.0, 300.0, 400.0, 500.0]
       mapper = fitmap(retention_times, retention_indices);

julia&gt; mapmax(mapper) ≈ 9.3u&quot;minute&quot;
true

julia&gt; mapmax(mapper, unit=u&quot;s&quot;) ≈ 558.0u&quot;s&quot;
true

julia&gt; (mapmin(mapper), mapmax(mapper)) .≈ (1.2u&quot;minute&quot;, 9.3u&quot;minute&quot;)
(true, true)

julia&gt; inputs = [1.2, 2.5, 4.1, 6.8, 9.3]
       outputs = [100.0, 200.0, 300.0, 400.0, 500.0]
       mapper_unitless = fitmap(inputs, outputs);

julia&gt; mapmax(mapper_unitless) ≈ 9.3
true

julia&gt; mapmax(mapper_unitless, unit=u&quot;s&quot;)
ERROR: ArgumentError: Cannot convert unitless retention A minimum to a unit</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/oniehuis/JuChrom.jl/blob/dae4d2fb13e7d05a1fb199b701e38bb500504479/src/core/retention_mapping/map.jl#L1056-L1112">source</a></section></details></article><article><details class="docstring" open="true"><summary id="JuChrom.mapmin"><a class="docstring-binding" href="#JuChrom.mapmin"><code>JuChrom.mapmin</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">mapmin(rm::AbstractRetentionMapper; unit::Union{Nothing, Unitful.Units}=nothing)</code></pre><p>Return the minimum input value from domain A used during calibration.</p><p>For unitful mappers, the result carries units and can be converted with <code>unit</code>. For unitless mappers, <code>unit</code> must be <code>nothing</code>; otherwise <code>ArgumentError</code> is thrown with the message &quot;Cannot convert unitless retention A minimum to a unit&quot;.</p><p>See also <a href="#JuChrom.AbstractRetentionMapper"><code>AbstractRetentionMapper</code></a>,  <a href="#JuChrom.RetentionMapper"><code>RetentionMapper</code></a>, <a href="#JuChrom.applymap"><code>applymap</code></a>, <a href="#JuChrom.derivinvmap"><code>derivinvmap</code></a>, <a href="#JuChrom.derivmap"><code>derivmap</code></a>, <a href="#JuChrom.fitmap"><code>fitmap</code></a>, <a href="#JuChrom.invmap"><code>invmap</code></a>, <a href="#JuChrom.invmapmax"><code>invmapmax</code></a>, <a href="#JuChrom.invmapmin"><code>invmapmin</code></a>, <a href="#JuChrom.mapmax"><code>mapmax</code></a>, <a href="#JuChrom.rawapplymap"><code>rawapplymap</code></a>, <a href="#JuChrom.rawderivinvmap"><code>rawderivinvmap</code></a>, <a href="#JuChrom.rawderivmap"><code>rawderivmap</code></a>, <a href="#JuChrom.rawinvmap"><code>rawinvmap</code></a>, <a href="#JuChrom.rawinvmapmax"><code>rawinvmapmax</code></a>, <a href="#JuChrom.rawinvmapmin"><code>rawinvmapmin</code></a>, <a href="#JuChrom.rawmapmax"><code>rawmapmax</code></a>, <a href="#JuChrom.rawmapmin"><code>rawmapmin</code></a>, <a href="#JuChrom.retentionunit_A"><code>retentionunit_A</code></a>,  <a href="#JuChrom.retentionunit_B"><code>retentionunit_B</code></a>.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; retention_times = [1.2, 2.5, 4.1, 6.8, 9.3]u&quot;minute&quot;
       retention_indices = [100.0, 200.0, 300.0, 400.0, 500.0]
       mapper = fitmap(retention_times, retention_indices);

julia&gt; mapmin(mapper) ≈ 1.2u&quot;minute&quot;
true

julia&gt; mapmin(mapper, unit=u&quot;s&quot;) ≈ 72.0u&quot;s&quot;
true

julia&gt; inputs = [1.2, 2.5, 4.1, 6.8, 9.3]
       outputs = [100.0, 200.0, 300.0, 400.0, 500.0]
       mapper_unitless = fitmap(inputs, outputs);

julia&gt; mapmin(mapper_unitless) ≈ 1.2
true

julia&gt; mapmin(mapper_unitless, unit=u&quot;s&quot;)
ERROR: ArgumentError: Cannot convert unitless retention A minimum to a unit</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/oniehuis/JuChrom.jl/blob/dae4d2fb13e7d05a1fb199b701e38bb500504479/src/core/retention_mapping/map.jl#L1127-L1180">source</a></section></details></article><article><details class="docstring" open="true"><summary id="JuChrom.rawinvmapmax"><a class="docstring-binding" href="#JuChrom.rawinvmapmax"><code>JuChrom.rawinvmapmax</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">rawinvmapmax(rm::AbstractRetentionMapper; unit::Union{Nothing, Unitful.Units}=nothing)</code></pre><p>Return the maximum predicted value of domain B with units stripped.</p><p>For unitful mappers, <code>unit</code> converts values before stripping. For unitless mappers, <code>unit</code> must be <code>nothing</code>; otherwise <code>ArgumentError</code> is thrown with the message &quot;Cannot convert unitless retention B maximum to a unit&quot;.</p><p>See also <a href="#JuChrom.AbstractRetentionMapper"><code>AbstractRetentionMapper</code></a>,  <a href="#JuChrom.RetentionMapper"><code>RetentionMapper</code></a>, <a href="#JuChrom.applymap"><code>applymap</code></a>, <a href="#JuChrom.derivinvmap"><code>derivinvmap</code></a>, <a href="#JuChrom.derivmap"><code>derivmap</code></a>, <a href="#JuChrom.fitmap"><code>fitmap</code></a>, <a href="#JuChrom.invmap"><code>invmap</code></a>, <a href="#JuChrom.invmapmax"><code>invmapmax</code></a>, <a href="#JuChrom.invmapmin"><code>invmapmin</code></a>, <a href="#JuChrom.mapmax"><code>mapmax</code></a>, <a href="#JuChrom.mapmin"><code>mapmin</code></a>, <a href="#JuChrom.rawapplymap"><code>rawapplymap</code></a>, <a href="#JuChrom.rawderivinvmap"><code>rawderivinvmap</code></a>, <a href="#JuChrom.rawderivmap"><code>rawderivmap</code></a>, <a href="#JuChrom.rawinvmap"><code>rawinvmap</code></a>, <a href="#JuChrom.rawinvmapmin"><code>rawinvmapmin</code></a>, <a href="#JuChrom.rawmapmax"><code>rawmapmax</code></a>, <a href="#JuChrom.rawmapmin"><code>rawmapmin</code></a>, <a href="#JuChrom.retentionunit_A"><code>retentionunit_A</code></a>,  <a href="#JuChrom.retentionunit_B"><code>retentionunit_B</code></a>.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; retention_times = [1.2, 2.5, 4.1, 6.8, 9.3]u&quot;minute&quot;
       retention_indices = [100.0, 200.0, 300.0, 400.0, 500.0]
       mapper = fitmap(retention_times, retention_indices);

julia&gt; rawinvmapmax(mapper) ≈ 499.9999793028839
true

julia&gt; inputs = [1.2, 2.5, 4.1, 6.8, 9.3]
       outputs = [100.0, 200.0, 300.0, 400.0, 500.0]
       mapper_unitless = fitmap(inputs, outputs);

julia&gt; rawinvmapmax(mapper_unitless) ≈ 499.9999793028839
true

julia&gt; rawinvmapmax(mapper_unitless, unit=u&quot;s&quot;)
ERROR: ArgumentError: Cannot convert unitless retention A minimum to a unit</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/oniehuis/JuChrom.jl/blob/dae4d2fb13e7d05a1fb199b701e38bb500504479/src/core/retention_mapping/map.jl#L1680-L1730">source</a></section></details></article><article><details class="docstring" open="true"><summary id="JuChrom.rawinvmapmin"><a class="docstring-binding" href="#JuChrom.rawinvmapmin"><code>JuChrom.rawinvmapmin</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">rawinvmapmin(rm::AbstractRetentionMapper; unit::Union{Nothing, Unitful.Units}=nothing)</code></pre><p>Return the minimum predicted value of domain B with units stripped.</p><p>For unitful mappers, <code>unit</code> converts values before stripping. For unitless mappers, <code>unit</code> must be <code>nothing</code>; otherwise <code>ArgumentError</code> is thrown with the message &quot;Cannot convert unitless retention B minimum to a unit&quot;.</p><p>See also <a href="#JuChrom.AbstractRetentionMapper"><code>AbstractRetentionMapper</code></a>,  <a href="#JuChrom.RetentionMapper"><code>RetentionMapper</code></a>, <a href="#JuChrom.applymap"><code>applymap</code></a>, <a href="#JuChrom.derivinvmap"><code>derivinvmap</code></a>, <a href="#JuChrom.derivmap"><code>derivmap</code></a>, <a href="#JuChrom.fitmap"><code>fitmap</code></a>, <a href="#JuChrom.invmap"><code>invmap</code></a>, <a href="#JuChrom.invmapmax"><code>invmapmax</code></a>, <a href="#JuChrom.invmapmin"><code>invmapmin</code></a>, <a href="#JuChrom.mapmax"><code>mapmax</code></a>, <a href="#JuChrom.mapmin"><code>mapmin</code></a>, <a href="#JuChrom.rawapplymap"><code>rawapplymap</code></a>, <a href="#JuChrom.rawderivinvmap"><code>rawderivinvmap</code></a>, <a href="#JuChrom.rawderivmap"><code>rawderivmap</code></a>, <a href="#JuChrom.rawinvmap"><code>rawinvmap</code></a>, <a href="#JuChrom.rawinvmapmax"><code>rawinvmapmax</code></a>, <a href="#JuChrom.rawmapmax"><code>rawmapmax</code></a>, <a href="#JuChrom.rawmapmin"><code>rawmapmin</code></a>, <a href="#JuChrom.retentionunit_A"><code>retentionunit_A</code></a>,  <a href="#JuChrom.retentionunit_B"><code>retentionunit_B</code></a>.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; retention_times = [1.2, 2.5, 4.1, 6.8, 9.3]u&quot;minute&quot;
       retention_indices = [100.0, 200.0, 300.0, 400.0, 500.0]
       mapper = fitmap(retention_times, retention_indices);

julia&gt; rawinvmapmin(mapper) ≈ 100.00001207241763
true

julia&gt; (rawinvmapmin(mapper), rawinvmapmax(mapper)) .≈ (100.00001207241763, 499.9999793028839)
(true, true)

julia&gt; inputs = [1.2, 2.5, 4.1, 6.8, 9.3]
       outputs = [100.0, 200.0, 300.0, 400.0, 500.0]
       mapper_unitless = fitmap(inputs, outputs);

julia&gt; rawinvmapmin(mapper_unitless) ≈ 100.00001207241763
true

julia&gt; rawinvmapmin(mapper_unitless, unit=u&quot;s&quot;)
ERROR: ArgumentError: Cannot convert unitless retention A minimum to a unit</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/oniehuis/JuChrom.jl/blob/dae4d2fb13e7d05a1fb199b701e38bb500504479/src/core/retention_mapping/map.jl#L1745-L1798">source</a></section></details></article><article><details class="docstring" open="true"><summary id="JuChrom.rawmapmax"><a class="docstring-binding" href="#JuChrom.rawmapmax"><code>JuChrom.rawmapmax</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">rawmapmax(rm::AbstractRetentionMapper; unit::Union{Nothing, Unitful.Units}=nothing)</code></pre><p>Return the maximum input value of domain A with units stripped.</p><p>For unitful mappers, <code>unit</code> converts values before stripping. For unitless mappers, <code>unit</code> must be <code>nothing</code>; otherwise <code>ArgumentError</code> is thrown with the message &quot;Cannot convert unitless retention A maximum to a unit&quot;.</p><p>See also <a href="#JuChrom.AbstractRetentionMapper"><code>AbstractRetentionMapper</code></a>,  <a href="#JuChrom.RetentionMapper"><code>RetentionMapper</code></a>, <a href="#JuChrom.applymap"><code>applymap</code></a>, <a href="#JuChrom.derivinvmap"><code>derivinvmap</code></a>, <a href="#JuChrom.derivmap"><code>derivmap</code></a>, <a href="#JuChrom.fitmap"><code>fitmap</code></a>, <a href="#JuChrom.invmap"><code>invmap</code></a>, <a href="#JuChrom.invmapmax"><code>invmapmax</code></a>, <a href="#JuChrom.invmapmin"><code>invmapmin</code></a>, <a href="#JuChrom.mapmax"><code>mapmax</code></a>, <a href="#JuChrom.mapmin"><code>mapmin</code></a>, <a href="#JuChrom.rawapplymap"><code>rawapplymap</code></a>, <a href="#JuChrom.rawderivinvmap"><code>rawderivinvmap</code></a>, <a href="#JuChrom.rawderivmap"><code>rawderivmap</code></a>, <a href="#JuChrom.rawinvmap"><code>rawinvmap</code></a>, <a href="#JuChrom.rawinvmapmax"><code>rawinvmapmax</code></a>, <a href="#JuChrom.rawinvmapmin"><code>rawinvmapmin</code></a>, <a href="#JuChrom.rawmapmin"><code>rawmapmin</code></a>, <a href="#JuChrom.retentionunit_A"><code>retentionunit_A</code></a>,  <a href="#JuChrom.retentionunit_B"><code>retentionunit_B</code></a>.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; retention_times = [1.2, 2.5, 4.1, 6.8, 9.3]u&quot;minute&quot;
       retention_indices = [100.0, 200.0, 300.0, 400.0, 500.0]
       mapper = fitmap(retention_times, retention_indices);

julia&gt; rawmapmax(mapper) ≈ 9.3
true

julia&gt; rawmapmax(mapper, unit=u&quot;s&quot;) ≈ 558.0
true

julia&gt; (rawmapmin(mapper), rawmapmax(mapper)) .≈ (1.2, 9.3)
(true, true)

julia&gt; inputs = [1.2, 2.5, 4.1, 6.8, 9.3]
       outputs = [100.0, 200.0, 300.0, 400.0, 500.0]
       mapper_unitless = fitmap(inputs, outputs);

julia&gt; rawmapmax(mapper_unitless) ≈ 9.3
true

julia&gt; rawmapmax(mapper_unitless, unit=u&quot;s&quot;)
ERROR: ArgumentError: Cannot convert unitless retention A minimum to a unit</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/oniehuis/JuChrom.jl/blob/dae4d2fb13e7d05a1fb199b701e38bb500504479/src/core/retention_mapping/map.jl#L1813-L1869">source</a></section></details></article><article><details class="docstring" open="true"><summary id="JuChrom.rawmapmin"><a class="docstring-binding" href="#JuChrom.rawmapmin"><code>JuChrom.rawmapmin</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">rawmapmin(rm::AbstractRetentionMapper; unit::Union{Nothing, Unitful.Units}=nothing)</code></pre><p>Return the minimum input value of domain A with units stripped.</p><p>For unitful mappers, <code>unit</code> converts values before stripping. For unitless mappers, <code>unit</code> must be <code>nothing</code>; otherwise <code>ArgumentError</code> is thrown with the message &quot;Cannot convert unitless retention A minimum to a unit&quot;.</p><p>See also <a href="#JuChrom.AbstractRetentionMapper"><code>AbstractRetentionMapper</code></a>,  <a href="#JuChrom.RetentionMapper"><code>RetentionMapper</code></a>, <a href="#JuChrom.applymap"><code>applymap</code></a>, <a href="#JuChrom.derivinvmap"><code>derivinvmap</code></a>, <a href="#JuChrom.derivmap"><code>derivmap</code></a>, <a href="#JuChrom.fitmap"><code>fitmap</code></a>, <a href="#JuChrom.invmap"><code>invmap</code></a>, <a href="#JuChrom.invmapmax"><code>invmapmax</code></a>, <a href="#JuChrom.invmapmin"><code>invmapmin</code></a>, <a href="#JuChrom.mapmax"><code>mapmax</code></a>, <a href="#JuChrom.mapmin"><code>mapmin</code></a>, <a href="#JuChrom.rawapplymap"><code>rawapplymap</code></a>, <a href="#JuChrom.rawderivinvmap"><code>rawderivinvmap</code></a>, <a href="#JuChrom.rawderivmap"><code>rawderivmap</code></a>, <a href="#JuChrom.rawinvmap"><code>rawinvmap</code></a>, <a href="#JuChrom.rawinvmapmax"><code>rawinvmapmax</code></a>, <a href="#JuChrom.rawinvmapmin"><code>rawinvmapmin</code></a>, <a href="#JuChrom.rawmapmax"><code>rawmapmax</code></a>, <a href="#JuChrom.retentionunit_A"><code>retentionunit_A</code></a>,  <a href="#JuChrom.retentionunit_B"><code>retentionunit_B</code></a>.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; retention_times = [1.2, 2.5, 4.1, 6.8, 9.3]u&quot;minute&quot;
       retention_indices = [100.0, 200.0, 300.0, 400.0, 500.0]
       mapper = fitmap(retention_times, retention_indices);

julia&gt; rawmapmin(mapper) ≈ 1.2
true

julia&gt; rawmapmin(mapper, unit=u&quot;s&quot;) ≈ 72.0
true

julia&gt; inputs = [1.2, 2.5, 4.1, 6.8, 9.3]
       outputs = [100.0, 200.0, 300.0, 400.0, 500.0]
       mapper_unitless = fitmap(inputs, outputs);

julia&gt; rawmapmin(mapper_unitless) ≈ 1.2
true

julia&gt; rawmapmin(mapper_unitless, unit=u&quot;s&quot;)
ERROR: ArgumentError: Cannot convert unitless retention A minimum to a unit</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/oniehuis/JuChrom.jl/blob/dae4d2fb13e7d05a1fb199b701e38bb500504479/src/core/retention_mapping/map.jl#L1884-L1937">source</a></section></details></article><article><details class="docstring" open="true"><summary id="JuChrom.rawretentions_A"><a class="docstring-binding" href="#JuChrom.rawretentions_A"><code>JuChrom.rawretentions_A</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">rawretentions_A(rm::AbstractRetentionMapper;
                unit::Union{Nothing, Unitful.Units}=nothing)</code></pre><p>Return the raw numeric calibration inputs from domain A, with units stripped.</p><p>For unitful mappers, <code>unit</code> converts the values before stripping. For unitless mappers, <code>unit</code> must be <code>nothing</code>; otherwise <code>ArgumentError</code> is thrown with the message &quot;Cannot convert unitless retention A to a unit&quot;.</p><p>See also <a href="#JuChrom.AbstractRetentionMapper"><code>AbstractRetentionMapper</code></a>, <a href="#JuChrom.RetentionMapper"><code>RetentionMapper</code></a>, <a href="#JuChrom.fitmap"><code>fitmap</code></a>, <a href="#JuChrom.invmapmax"><code>invmapmax</code></a>, <a href="#JuChrom.invmapmin"><code>invmapmin</code></a>, <a href="#JuChrom.mapmax"><code>mapmax</code></a>, <a href="#JuChrom.mapmin"><code>mapmin</code></a>, <a href="#JuChrom.rawinvmapmax"><code>rawinvmapmax</code></a>, <a href="#JuChrom.rawinvmapmin"><code>rawinvmapmin</code></a>, <a href="#JuChrom.rawmapmax"><code>rawmapmax</code></a>, <a href="#JuChrom.rawmapmin"><code>rawmapmin</code></a>, <a href="#JuChrom.rawretentions_B"><code>rawretentions_B</code></a>, <a href="#JuChrom.retentions_A"><code>retentions_A</code></a>, <a href="#JuChrom.retentions_B"><code>retentions_B</code></a>, <a href="#JuChrom.retentionunit_A"><code>retentionunit_A</code></a>, <a href="#JuChrom.retentionunit_B"><code>retentionunit_B</code></a>.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; retention_times = [1.2, 2.5, 4.1, 6.8, 9.3]u&quot;minute&quot;
       retention_indices = [100.0, 200.0, 300.0, 400.0, 500.0]
       mapper = fitmap(retention_times, retention_indices);

julia&gt; rawretentions_A(mapper) ≈ [1.2, 2.5, 4.1, 6.8, 9.3]
true

julia&gt; rawretentions_A(mapper, unit=u&quot;s&quot;) ≈ [72.0, 150.0, 246.0, 408.0, 558.0]
true

julia&gt; inputs = [1.2, 2.5, 4.1, 6.8, 9.3]
       outputs = [100.0, 200.0, 300.0, 400.0, 500.0]
       mapper_unitless = fitmap(inputs, outputs);

julia&gt; rawretentions_A(mapper_unitless) ≈ [1.2, 2.5, 4.1, 6.8, 9.3]
true

julia&gt; rawretentions_A(mapper_unitless, unit=u&quot;s&quot;)
ERROR: ArgumentError: Cannot convert unitless retention A to a unit</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/oniehuis/JuChrom.jl/blob/dae4d2fb13e7d05a1fb199b701e38bb500504479/src/core/retention_mapping/container.jl#L316-L366">source</a></section></details></article><article><details class="docstring" open="true"><summary id="JuChrom.rawretentions_B"><a class="docstring-binding" href="#JuChrom.rawretentions_B"><code>JuChrom.rawretentions_B</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">rawretentions_B(rm::AbstractRetentionMapper;
                unit::Union{Nothing, Unitful.Units}=nothing)</code></pre><p>Return the raw numeric calibration outputs from domain B, with units stripped.</p><p>For unitful mappers, <code>unit</code> converts the values before stripping. For unitless mappers, <code>unit</code> must be <code>nothing</code>; otherwise <code>ArgumentError</code> is thrown with the message &quot;Cannot convert unitless retention B to a unit&quot;.</p><p>See also <a href="#JuChrom.AbstractRetentionMapper"><code>AbstractRetentionMapper</code></a>, <a href="#JuChrom.RetentionMapper"><code>RetentionMapper</code></a>, <a href="#JuChrom.fitmap"><code>fitmap</code></a>, <a href="#JuChrom.invmapmax"><code>invmapmax</code></a>, <a href="#JuChrom.invmapmin"><code>invmapmin</code></a>, <a href="#JuChrom.mapmax"><code>mapmax</code></a>, <a href="#JuChrom.mapmin"><code>mapmin</code></a>, <a href="#JuChrom.rawinvmapmax"><code>rawinvmapmax</code></a>, <a href="#JuChrom.rawinvmapmin"><code>rawinvmapmin</code></a>, <a href="#JuChrom.rawmapmax"><code>rawmapmax</code></a>, <a href="#JuChrom.rawmapmin"><code>rawmapmin</code></a>, <a href="#JuChrom.rawretentions_A"><code>rawretentions_A</code></a>, <a href="#JuChrom.retentions_A"><code>retentions_A</code></a>, <a href="#JuChrom.retentions_B"><code>retentions_B</code></a>, <a href="#JuChrom.retentionunit_A"><code>retentionunit_A</code></a>, <a href="#JuChrom.retentionunit_B"><code>retentionunit_B</code></a>.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; retention_times = [1.2, 2.5, 4.1, 6.8, 9.3]u&quot;minute&quot;
       retention_indices = [100.0, 200.0, 300.0, 400.0, 500.0]
       mapper = fitmap(retention_times, retention_indices);

julia&gt; rawretentions_B(mapper) ≈ [100.0, 200.0, 300.0, 400.0, 500.0]
true

julia&gt; rawretentions_B(mapper, unit=u&quot;s&quot;)
ERROR: ArgumentError: Cannot convert unitless retention B to a unit</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/oniehuis/JuChrom.jl/blob/dae4d2fb13e7d05a1fb199b701e38bb500504479/src/core/retention_mapping/container.jl#L381-L421">source</a></section></details></article><article><details class="docstring" open="true"><summary id="JuChrom.retentions_A"><a class="docstring-binding" href="#JuChrom.retentions_A"><code>JuChrom.retentions_A</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">retentions_A(rm::AbstractRetentionMapper; unit::Union{Nothing, Unitful.Units}=nothing)</code></pre><p>Return the calibration inputs from domain A used to fit the mapper.</p><p>For unitful mappers, values are returned with units and can be converted with <code>unit</code>. For unitless mappers, raw numeric values are returned and <code>unit</code> must be <code>nothing</code>; otherwise <code>ArgumentError</code> is thrown with the message &quot;Cannot convert unitless retention A to a unit&quot;.</p><p>See also <a href="#JuChrom.AbstractRetentionMapper"><code>AbstractRetentionMapper</code></a>, <a href="#JuChrom.RetentionMapper"><code>RetentionMapper</code></a>, <a href="#JuChrom.fitmap"><code>fitmap</code></a>, <a href="#JuChrom.invmapmax"><code>invmapmax</code></a>, <a href="#JuChrom.invmapmin"><code>invmapmin</code></a>, <a href="#JuChrom.mapmax"><code>mapmax</code></a>, <a href="#JuChrom.mapmin"><code>mapmin</code></a>, <a href="#JuChrom.rawinvmapmax"><code>rawinvmapmax</code></a>, <a href="#JuChrom.rawinvmapmin"><code>rawinvmapmin</code></a>, <a href="#JuChrom.rawmapmax"><code>rawmapmax</code></a>, <a href="#JuChrom.rawmapmin"><code>rawmapmin</code></a>, <a href="#JuChrom.rawretentions_A"><code>rawretentions_A</code></a>, <a href="#JuChrom.rawretentions_B"><code>rawretentions_B</code></a>, <a href="#JuChrom.retentions_B"><code>retentions_B</code></a>, <a href="#JuChrom.retentionunit_A"><code>retentionunit_A</code></a>, <a href="#JuChrom.retentionunit_B"><code>retentionunit_B</code></a>.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; retention_times = [1.2, 2.5, 4.1, 6.8, 9.3]u&quot;minute&quot;
       retention_indices = [100.0, 200.0, 300.0, 400.0, 500.0]
       mapper = fitmap(retention_times, retention_indices);

julia&gt; retentions_A(mapper) ≈ [1.2, 2.5, 4.1, 6.8, 9.3]u&quot;minute&quot;
true

julia&gt; retentions_A(mapper, unit=u&quot;s&quot;) ≈ [72.0, 150.0, 246.0, 408.0, 558.0]u&quot;s&quot;
true

julia&gt; inputs = [1.2, 2.5, 4.1, 6.8, 9.3]
       outputs = [100.0, 200.0, 300.0, 400.0, 500.0]
       mapper_unitless = fitmap(inputs, outputs);

julia&gt; retentions_A(mapper_unitless) ≈ [1.2, 2.5, 4.1, 6.8, 9.3]
true

julia&gt; retentions_A(mapper_unitless, unit=u&quot;s&quot;)
ERROR: ArgumentError: Cannot convert unitless retention A to a unit</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/oniehuis/JuChrom.jl/blob/dae4d2fb13e7d05a1fb199b701e38bb500504479/src/core/retention_mapping/container.jl#L436-L486">source</a></section></details></article><article><details class="docstring" open="true"><summary id="JuChrom.retentions_B"><a class="docstring-binding" href="#JuChrom.retentions_B"><code>JuChrom.retentions_B</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">retentions_B(rm::AbstractRetentionMapper; unit::Union{Nothing, Unitful.Units}=nothing)</code></pre><p>Return the calibration outputs from domain B used to fit the mapper.</p><p>For unitful mappers, values are returned with units and can be converted with <code>unit</code>. For unitless mappers, raw numeric values are returned and <code>unit</code> must be <code>nothing</code>; otherwise <code>ArgumentError</code> is thrown with the message &quot;Cannot convert unitless retention B to a unit&quot;.</p><p>See also <a href="#JuChrom.AbstractRetentionMapper"><code>AbstractRetentionMapper</code></a>, <a href="#JuChrom.RetentionMapper"><code>RetentionMapper</code></a>, <a href="#JuChrom.fitmap"><code>fitmap</code></a>, <a href="#JuChrom.invmapmax"><code>invmapmax</code></a>, <a href="#JuChrom.invmapmin"><code>invmapmin</code></a>, <a href="#JuChrom.mapmax"><code>mapmax</code></a>, <a href="#JuChrom.mapmin"><code>mapmin</code></a>, <a href="#JuChrom.rawinvmapmax"><code>rawinvmapmax</code></a>, <a href="#JuChrom.rawinvmapmin"><code>rawinvmapmin</code></a>, <a href="#JuChrom.rawmapmax"><code>rawmapmax</code></a>, <a href="#JuChrom.rawmapmin"><code>rawmapmin</code></a>, <a href="#JuChrom.rawretentions_A"><code>rawretentions_A</code></a>, <a href="#JuChrom.rawretentions_B"><code>rawretentions_B</code></a>, <a href="#JuChrom.retentions_A"><code>retentions_A</code></a>, <a href="#JuChrom.retentionunit_A"><code>retentionunit_A</code></a>, <a href="#JuChrom.retentionunit_B"><code>retentionunit_B</code></a>.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; retention_times = [1.2, 2.5, 4.1, 6.8, 9.3]u&quot;minute&quot;
       retention_indices = [100.0, 200.0, 300.0, 400.0, 500.0]
       mapper = fitmap(retention_times, retention_indices);

julia&gt; retentions_B(mapper) ≈ [100.0, 200.0, 300.0, 400.0, 500.0]
true

julia&gt; retentions_B(mapper, unit=u&quot;s&quot;)
ERROR: ArgumentError: Cannot convert unitless retention B to a unit</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/oniehuis/JuChrom.jl/blob/dae4d2fb13e7d05a1fb199b701e38bb500504479/src/core/retention_mapping/container.jl#L501-L541">source</a></section></details></article><article><details class="docstring" open="true"><summary id="JuChrom.retentionunit_A"><a class="docstring-binding" href="#JuChrom.retentionunit_A"><code>JuChrom.retentionunit_A</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">retentionunit_A(mapper::AbstractRetentionMapper)</code></pre><p>Return the unit associated with the input domain (domain A) of the retention mapper.</p><p>For unitful mappers, this returns the <code>Unitful.Units</code> object representing the unit of the input values. For unitless mappers, it returns <code>nothing</code>.</p><p>See also <a href="#JuChrom.AbstractRetentionMapper"><code>AbstractRetentionMapper</code></a>, <a href="#JuChrom.RetentionMapper"><code>RetentionMapper</code></a>, <a href="#JuChrom.fitmap"><code>fitmap</code></a>, <a href="#JuChrom.invmapmax"><code>invmapmax</code></a>, <a href="#JuChrom.invmapmin"><code>invmapmin</code></a>, <a href="#JuChrom.mapmax"><code>mapmax</code></a>, <a href="#JuChrom.mapmin"><code>mapmin</code></a>, <a href="#JuChrom.rawinvmapmax"><code>rawinvmapmax</code></a>, <a href="#JuChrom.rawinvmapmin"><code>rawinvmapmin</code></a>, <a href="#JuChrom.rawmapmax"><code>rawmapmax</code></a>, <a href="#JuChrom.rawmapmin"><code>rawmapmin</code></a>, <a href="#JuChrom.rawretentions_A"><code>rawretentions_A</code></a>, <a href="#JuChrom.rawretentions_B"><code>rawretentions_B</code></a>, <a href="#JuChrom.retentions_A"><code>retentions_A</code></a>, <a href="#JuChrom.retentions_B"><code>retentions_B</code></a>, <a href="#JuChrom.retentionunit_B"><code>retentionunit_B</code></a>.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; retention_times = [1.2, 2.5, 4.1, 6.8, 9.3]u&quot;minute&quot;
       retention_indices = [100.0, 200.0, 300.0, 400.0, 500.0]
       mapper = fitmap(retention_times, retention_indices);

julia&gt; retentionunit_A(mapper)
minute

julia&gt; inputs = [1.2, 2.5, 4.1, 6.8, 9.3]
       outputs = [100.0, 200.0, 300.0, 400.0, 500.0]
       mapper_unitless = fitmap(inputs, outputs);

julia&gt; retentionunit_A(mapper_unitless) === nothing
true</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/oniehuis/JuChrom.jl/blob/dae4d2fb13e7d05a1fb199b701e38bb500504479/src/core/retention_mapping/container.jl#L556-L598">source</a></section></details></article><article><details class="docstring" open="true"><summary id="JuChrom.retentionunit_B"><a class="docstring-binding" href="#JuChrom.retentionunit_B"><code>JuChrom.retentionunit_B</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">retentionunit_B(mapper::AbstractRetentionMapper)</code></pre><p>Return the unit associated with the output domain (domain B) of the retention mapper.</p><p>For unitful mappers, this returns the <code>Unitful.Units</code> object representing the unit of the output values. For unitless mappers, it returns <code>nothing</code>.</p><p>See also <a href="#JuChrom.AbstractRetentionMapper"><code>AbstractRetentionMapper</code></a>, <a href="#JuChrom.RetentionMapper"><code>RetentionMapper</code></a>, <a href="#JuChrom.fitmap"><code>fitmap</code></a>, <a href="#JuChrom.invmapmax"><code>invmapmax</code></a>, <a href="#JuChrom.invmapmin"><code>invmapmin</code></a>, <a href="#JuChrom.mapmax"><code>mapmax</code></a>, <a href="#JuChrom.mapmin"><code>mapmin</code></a>, <a href="#JuChrom.rawinvmapmax"><code>rawinvmapmax</code></a>, <a href="#JuChrom.rawinvmapmin"><code>rawinvmapmin</code></a>, <a href="#JuChrom.rawmapmax"><code>rawmapmax</code></a>, <a href="#JuChrom.rawmapmin"><code>rawmapmin</code></a>, <a href="#JuChrom.rawretentions_A"><code>rawretentions_A</code></a>, <a href="#JuChrom.rawretentions_B"><code>rawretentions_B</code></a>, <a href="#JuChrom.retentions_A"><code>retentions_A</code></a>, <a href="#JuChrom.retentions_B"><code>retentions_B</code></a>, <a href="#JuChrom.retentionunit_A"><code>retentionunit_A</code></a>.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; retention_times = [1.2, 2.5, 4.1, 6.8, 9.3]u&quot;minute&quot;
       retention_indices = [100.0, 200.0, 300.0, 400.0, 500.0]
       mapper = fitmap(retention_times, retention_indices);

julia&gt; retentionunit_B(mapper) === nothing
true</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/oniehuis/JuChrom.jl/blob/dae4d2fb13e7d05a1fb199b701e38bb500504479/src/core/retention_mapping/container.jl#L603-L638">source</a></section></details></article><h2 id="RetentionMapper"><a class="docs-heading-anchor" href="#RetentionMapper">RetentionMapper</a><a id="RetentionMapper-1"></a><a class="docs-heading-anchor-permalink" href="#RetentionMapper" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="JuChrom.RetentionMapper"><a class="docstring-binding" href="#JuChrom.RetentionMapper"><code>JuChrom.RetentionMapper</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">RetentionMapper{T1, T2, T3, T4, T5, T6, T7, T8, T9, T10, T11, T12, T13, T14, T15, T16, T17} &lt;: AbstractRetentionMapper{T2, T8}</code></pre><p>Concrete container for a fitted monotone mapping between two retention domains.</p><p><code>T2</code> and <code>T8</code> encode the input and output unit types (each a <code>Unitful.Units</code> subtype or <code>Nothing</code>). The remaining type parameters capture the stored numeric arrays, normalization bounds, and spline coefficients used by the mapping functions.</p><p>Fields include  <code>rA::AbstractVector{&lt;:Real}</code> – the raw numeric calibration data values from the input domain, <code>rA_unit::Union{Unitful.Units, Nothing}</code> – the unit associated with the input domain, <code>rA_min::Real</code> – the minimum value of the input domain data, <code>rA_max::Real</code> – the maximum value of the input domain data, <code>rA_norm_min::Real</code> – the minimum normalized input value used for the spline fit, <code>rA_norm_max::Real</code> – the maximum normalized input value used for the spline fit,   where <code>rA_norm = (rA - rA_min) / (rA_max - rA_min)</code>, <code>rB::AbstractVector{&lt;:Real}</code> – the raw numeric calibration data values from the output domain, <code>rB_unit::Union{Unitful.Units, Nothing}</code> – the unit associated with the output domain, <code>rB_min::Real</code> – the minimum value of the output domain data, <code>rB_max::Real</code> – the maximum value of the output domain data, <code>rB_pred_min::Real</code> – the minimum predicted output value over the fitted domain, <code>rB_pred_max::Real</code> – the maximum predicted output value over the fitted domain, <code>rB_pred_norm_min::Real</code> – the minimum normalized predicted output value, <code>rB_pred_norm_max::Real</code> – the maximum normalized predicted output value,   where <code>rB_pred_norm = (rB_pred - rB_min) / (rB_max - rB_min)</code>, <code>knots::AbstractVector{&lt;:Real}</code> – the B-spline knot sequence, <code>coefs::AbstractVector{&lt;:Real}</code> – the spline coefficients, <code>spline::Spline</code> – the fitted spline object, and <code>extras::Dict{String, Any}</code> – a metadata dictionary associated with the retention mapper.</p><p>See also <a href="#JuChrom.AbstractRetentionMapper"><code>AbstractRetentionMapper</code></a>,  <a href="#JuChrom.applymap"><code>applymap</code></a>, <a href="#JuChrom.derivinvmap"><code>derivinvmap</code></a>, <a href="#JuChrom.derivmap"><code>derivmap</code></a>, <a href="#JuChrom.extras-Tuple{JuChrom.AbstractRetentionMapper}"><code>extras</code></a>, <a href="#JuChrom.fitmap"><code>fitmap</code></a>, <a href="#JuChrom.invmap"><code>invmap</code></a>, <a href="#JuChrom.invmapmax"><code>invmapmax</code></a>, <a href="#JuChrom.invmapmin"><code>invmapmin</code></a>, <a href="#JuChrom.mapmax"><code>mapmax</code></a>, <a href="#JuChrom.mapmin"><code>mapmin</code></a>, <a href="#JuChrom.rawapplymap"><code>rawapplymap</code></a>, <a href="#JuChrom.rawderivinvmap"><code>rawderivinvmap</code></a>, <a href="#JuChrom.rawderivmap"><code>rawderivmap</code></a>, <a href="#JuChrom.rawinvmap"><code>rawinvmap</code></a>, <a href="#JuChrom.rawinvmapmax"><code>rawinvmapmax</code></a>, <a href="#JuChrom.rawinvmapmin"><code>rawinvmapmin</code></a>, <a href="#JuChrom.rawmapmax"><code>rawmapmax</code></a>, <a href="#JuChrom.rawmapmin"><code>rawmapmin</code></a>, <a href="#JuChrom.rawretentions_A"><code>rawretentions_A</code></a>,  <a href="#JuChrom.rawretentions_B"><code>rawretentions_B</code></a>,  <a href="#JuChrom.retentions_A"><code>retentions_A</code></a>,  <a href="#JuChrom.retentions_B"><code>retentions_B</code></a>,  <a href="#JuChrom.retentionunit_A"><code>retentionunit_A</code></a>,  <a href="#JuChrom.retentionunit_B"><code>retentionunit_B</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/oniehuis/JuChrom.jl/blob/dae4d2fb13e7d05a1fb199b701e38bb500504479/src/core/retention_mapping/container.jl#L41-L98">source</a></section></details></article><article><details class="docstring" open="true"><summary id="JuChrom.applymap"><a class="docstring-binding" href="#JuChrom.applymap"><code>JuChrom.applymap</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">applymap(
    rm::RetentionMapper,
    retention::Union{&lt;:Real, &lt;:AbstractQuantity{&lt;:Real}}; 
    domain_boundary_threshold::Real=1e-8,
    warn::Bool=false, 
    unit::Union{&lt;:Nothing, Unitful.Units}=retentionunit_B(rm)
)</code></pre><p>Apply the fitted mapping to transform a retention value from domain A to domain B using the  fitted spline within the <code>RetentionMapper</code>.</p><p>Inputs are a fitted <code>rm</code>, a retention value (unitful or unitless), and <code>unit</code> for output conversion. <code>domain_boundary_threshold</code> sets how far beyond the normalized spline domain a value must lie before logging an extrapolation warning when <code>warn=true</code>.</p><p>Out-of-domain values are extrapolated linearly using the boundary slope, and the result is returned on the original scale with appropriate units.</p><p>See also <a href="#JuChrom.AbstractRetentionMapper"><code>AbstractRetentionMapper</code></a>,  <a href="#JuChrom.RetentionMapper"><code>RetentionMapper</code></a>, <a href="#JuChrom.derivinvmap"><code>derivinvmap</code></a>, <a href="#JuChrom.derivmap"><code>derivmap</code></a>, <a href="#JuChrom.fitmap"><code>fitmap</code></a>, <a href="#JuChrom.invmap"><code>invmap</code></a>, <a href="#JuChrom.invmapmax"><code>invmapmax</code></a>, <a href="#JuChrom.invmapmin"><code>invmapmin</code></a>, <a href="#JuChrom.mapmax"><code>mapmax</code></a>, <a href="#JuChrom.mapmin"><code>mapmin</code></a>, <a href="#JuChrom.rawapplymap"><code>rawapplymap</code></a>, <a href="#JuChrom.rawderivinvmap"><code>rawderivinvmap</code></a>, <a href="#JuChrom.rawderivmap"><code>rawderivmap</code></a>, <a href="#JuChrom.rawinvmap"><code>rawinvmap</code></a>, <a href="#JuChrom.rawinvmapmax"><code>rawinvmapmax</code></a>, <a href="#JuChrom.rawinvmapmin"><code>rawinvmapmin</code></a>, <a href="#JuChrom.rawmapmax"><code>rawmapmax</code></a>, <a href="#JuChrom.rawmapmin"><code>rawmapmin</code></a>, <a href="#JuChrom.retentionunit_A"><code>retentionunit_A</code></a>,  <a href="#JuChrom.retentionunit_B"><code>retentionunit_B</code></a>.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; retention_times = [1.2, 2.5, 4.1, 6.8, 9.3, 12.1, 15.7]u&quot;minute&quot;
       retention_indices = [100.0, 200.0, 300.0, 400.0, 500.0, 600.0, 700.0]u&quot;Th&quot;
       mapper = fitmap(retention_times, retention_indices);

julia&gt; applymap(mapper, 5.0u&quot;minute&quot;) ≈ 338.71144090340465u&quot;Th&quot;
true

julia&gt; applymap(mapper, 0.5u&quot;minute&quot;, warn=true) ≈ 44.68816899287087u&quot;Th&quot;
[ Info: rA=0.5 is below the spline domain boundary (rA_min=1.2): extrapolating left.
true</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/oniehuis/JuChrom.jl/blob/dae4d2fb13e7d05a1fb199b701e38bb500504479/src/core/retention_mapping/map.jl#L46-L100">source</a></section><section><div><pre><code class="language-julia hljs">applymap(
    rmap::RetentionMapper,
    series::MassScanSeries;
    domain_boundary_threshold::Real=1e-8,
    unit::Union{&lt;:Nothing, Unitful.Units}=retentionunit_B(rmap),
    warn::Bool=false
) -&gt; MassScanSeries</code></pre><p>Apply retention mapping <code>rmap</code> to <code>series</code>, transforming retention coordinates and scaling  intensities by the Jacobian to preserve peak areas.</p><p>For parameter descriptions and basic behavior, see <a href="#JuChrom.applymap"><code>applymap</code></a> for single retention  values.</p><p>Returns a new <code>MassScanSeries</code> with mapped retentions and Jacobian-corrected intensities.</p><p><code>applymap</code> treats intensities as densities with respect to retention coordinates. Monotonic  reparameterization A→B rescales intensities by 1/(dB/dA) to preserve peak areas. If your  data are integrated counts per scan with variable dwell times, convert to densities first  using dwell time before calling <code>applymap</code>. Only numerical values are transformed — units  remain unchanged. If intensities are densities with retention units in the denominator,  handle unit transformation separately.</p><p><strong>Examples</strong></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/oniehuis/JuChrom.jl/blob/dae4d2fb13e7d05a1fb199b701e38bb500504479/src/core/retention_mapping/map.jl#L124-L149">source</a></section><section><div><pre><code class="language-julia hljs">applymap(
    rmap::RetentionMapper,
    msm::MassScanMatrix;
    domain_boundary_threshold::Real=1e-8,
    unit::Union{&lt;:Nothing, Unitful.Units}=retentionunit_B(rmap),
    warn::Bool=false
) -&gt; MassScanMatrix</code></pre><p>Apply retention mapper <code>rmap</code> to <code>msm</code>, transforming retention coordinates and scaling intensities by the Jacobian to preserve peak areas.</p><p>For additional parameter descriptions and basic behavior, see <a href="#JuChrom.applymap"><code>applymap</code></a> for  single retention values.</p><p>Returns a new <code>MassScanMatrix</code> with mapped retentions and Jacobian-corrected intensities.</p><p><code>applymap</code> treats intensities as densities with respect to retention coordinates. Monotonic  reparameterization A→B rescales intensities by 1/(dB/dA) to preserve peak areas. If your  data are integrated counts per scan with variable dwell times, convert to densities first  using dwell time before calling <code>applymap</code>. Only numerical values are transformed — units  remain unchanged. If intensities are densities with retention units in the denominator,  handle unit transformation separately.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/oniehuis/JuChrom.jl/blob/dae4d2fb13e7d05a1fb199b701e38bb500504479/src/core/retention_mapping/map.jl#L320-L343">source</a></section></details></article><article><details class="docstring" open="true"><summary id="JuChrom.derivinvmap"><a class="docstring-binding" href="#JuChrom.derivinvmap"><code>JuChrom.derivinvmap</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">derivinvmap(
    rmap::RetentionMapper,
    retention::Union{&lt;:Real, &lt;:AbstractQuantity{&lt;:Real}};
    domain_boundary_threshold::Real=1e-8,
    rA_unit::Union{Nothing, Unitful.Units}=retentionunit_A(rmap)),
    rB_unit::Union{Nothing, Unitful.Units}=retentionunit_B(rmap)),
    tol::Real=1e-8, 
    warn::Bool=false
)</code></pre><p>Compute the derivative of the inverse mapping, i.e. d(A)/d(B), at a given output value  (domain B).</p><p>This function computes the local derivative <code>d(A)/d(B)</code> at a given output value using  the inverse of the normalized B-spline approximation stored in the <code>RetentionMapper</code>.  This derivative describes how a small change in the output (domain B) would translate  back to a change in the input (domain A), under the smoothed, monotonic mapping. If the  output value is outside the supported domain, extrapolation is performed using the boundary  derivative. The derivative is adjusted to account for the normalization scales applied  during spline fitting.</p><p>Inputs are a fitted <code>rm</code>, an output value in domain B, optional <code>rA_unit</code>/<code>rB_unit</code> for unit conversion, and <code>tol</code> for root-finding (absolute bisection tolerance when solving the  inverse; smaller values increase accuracy at higher cost). <code>domain_boundary_threshold</code> sets  how far beyond the normalized inverse spline domain a value must lie before logging an extrapolation warning when <code>warn=true</code>.</p><p>Returns the derivative d(A)/d(B) with units of <code>rA_unit/rB_unit</code>. This is the reciprocal of <a href="#JuChrom.derivmap"><code>derivmap</code></a>, is always positive under the monotonic constraint, and uses root-finding to locate the corresponding input value. Out-of-domain values use the boundary derivative.</p><p>See also <a href="#JuChrom.AbstractRetentionMapper"><code>AbstractRetentionMapper</code></a>,  <a href="#JuChrom.RetentionMapper"><code>RetentionMapper</code></a>, <a href="#JuChrom.applymap"><code>applymap</code></a>, <a href="#JuChrom.derivmap"><code>derivmap</code></a>, <a href="#JuChrom.fitmap"><code>fitmap</code></a>, <a href="#JuChrom.invmap"><code>invmap</code></a>, <a href="#JuChrom.invmapmax"><code>invmapmax</code></a>, <a href="#JuChrom.invmapmin"><code>invmapmin</code></a>, <a href="#JuChrom.mapmax"><code>mapmax</code></a>, <a href="#JuChrom.mapmin"><code>mapmin</code></a>, <a href="#JuChrom.rawapplymap"><code>rawapplymap</code></a>, <a href="#JuChrom.rawderivinvmap"><code>rawderivinvmap</code></a>, <a href="#JuChrom.rawderivmap"><code>rawderivmap</code></a>, <a href="#JuChrom.rawinvmap"><code>rawinvmap</code></a>, <a href="#JuChrom.rawinvmapmax"><code>rawinvmapmax</code></a>, <a href="#JuChrom.rawinvmapmin"><code>rawinvmapmin</code></a>, <a href="#JuChrom.rawmapmax"><code>rawmapmax</code></a>, <a href="#JuChrom.rawmapmin"><code>rawmapmin</code></a>, <a href="#JuChrom.retentionunit_A"><code>retentionunit_A</code></a>,  <a href="#JuChrom.retentionunit_B"><code>retentionunit_B</code></a>.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; retention_times = [1.2, 2.5, 4.1, 6.8, 9.3, 12.1, 15.7]u&quot;minute&quot;
       retention_indices = [100.0, 200.0, 300.0, 400.0, 500.0, 600.0, 700.0]u&quot;Th&quot;
       mapper = fitmap(retention_times, retention_indices);

julia&gt; derivinvmap(mapper, 350.0u&quot;Th&quot;) ≈ 0.02857099580171666u&quot;minute/Th&quot;
true

julia&gt; derivinvmap(mapper, 350.0)
ERROR: ArgumentError: Input must have units when rm.rB_unit is a Unitful unit. Expected units compatible with Th.

julia&gt; test_indices = [250.0, 600.0]u&quot;Th&quot;;

julia&gt; derivinvmap.(mapper, test_indices) ≈ [0.015606366497378708, 0.03240806524912834]u&quot;minute/Th&quot;
true

julia&gt; derivinvmap(mapper, 350.0u&quot;Th&quot;, rA_unit=u&quot;s&quot;, rB_unit=u&quot;kTh&quot;) ≈ 1714.2597481029995u&quot;s/kTh&quot;
true

julia&gt; derivinvmap(mapper, 50.0u&quot;Th&quot;, warn=true) ≈ 0.012655503630152843u&quot;minute/Th&quot;
[ Info: rB=50.0 is below the inverse spline domain boundary (rB_min=100.000073): extrapolating left.
true</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/oniehuis/JuChrom.jl/blob/dae4d2fb13e7d05a1fb199b701e38bb500504479/src/core/retention_mapping/map.jl#L453-L532">source</a></section></details></article><article><details class="docstring" open="true"><summary id="JuChrom.derivmap"><a class="docstring-binding" href="#JuChrom.derivmap"><code>JuChrom.derivmap</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">derivmap(
    rm::RetentionMapper,
    retention::Union{&lt;:Real, &lt;:AbstractQuantity{&lt;:Real}};
    rA_unit::Union{Nothing, Unitful.Units}=retentionunit_A(rm),
    rB_unit::Union{Nothing, Unitful.Units}=retentionunit_B(rm),
    warn::Bool=false
)</code></pre><p>Compute the first derivative of the fitted mapping with respect to the input (domain A)  at a given input value.</p><p>This function evaluates the derivative of the fitted monotonic B-spline, extrapolating  using boundary derivatives if the input lies outside the spline domain. The derivative is  adjusted to account for the normalization scales applied during spline fitting.</p><p>Inputs are a fitted <code>rm</code>, an input value in domain A, optional <code>rA_unit</code>/<code>rB_unit</code> for unit conversion, and <code>warn</code> to log extrapolation messages. <code>domain_boundary_threshold</code> sets how far beyond the normalized spline domain a value must lie before logging an extrapolation warning when <code>warn=true</code>.</p><p>Returns the derivative d(B)/d(A) with units of <code>rB_unit/rA_unit</code>. For retention time/retention index mappings, this gives the local “retention index per unit time” rate. The derivative is always positive due to the monotonicity constraint, and extrapolation uses constant boundary derivatives outside the fitted domain.</p><p>See also <a href="#JuChrom.AbstractRetentionMapper"><code>AbstractRetentionMapper</code></a>,  <a href="#JuChrom.RetentionMapper"><code>RetentionMapper</code></a>, <a href="#JuChrom.applymap"><code>applymap</code></a>, <a href="#JuChrom.derivinvmap"><code>derivinvmap</code></a>, <a href="#JuChrom.fitmap"><code>fitmap</code></a>, <a href="#JuChrom.invmap"><code>invmap</code></a>, <a href="#JuChrom.invmapmax"><code>invmapmax</code></a>, <a href="#JuChrom.invmapmin"><code>invmapmin</code></a>, <a href="#JuChrom.mapmax"><code>mapmax</code></a>, <a href="#JuChrom.mapmin"><code>mapmin</code></a>, <a href="#JuChrom.rawapplymap"><code>rawapplymap</code></a>, <a href="#JuChrom.rawderivinvmap"><code>rawderivinvmap</code></a>, <a href="#JuChrom.rawderivmap"><code>rawderivmap</code></a>, <a href="#JuChrom.rawinvmap"><code>rawinvmap</code></a>, <a href="#JuChrom.rawinvmapmax"><code>rawinvmapmax</code></a>, <a href="#JuChrom.rawinvmapmin"><code>rawinvmapmin</code></a>, <a href="#JuChrom.rawmapmax"><code>rawmapmax</code></a>, <a href="#JuChrom.rawmapmin"><code>rawmapmin</code></a>, <a href="#JuChrom.retentionunit_A"><code>retentionunit_A</code></a>,  <a href="#JuChrom.retentionunit_B"><code>retentionunit_B</code></a>.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; retention_times = [1.2, 2.5, 4.1, 6.8, 9.3, 12.1, 15.7]u&quot;minute&quot;
       retention_indices = [100.0, 200.0, 300.0, 400.0, 500.0, 600.0, 700.0]
       mapper = fitmap(retention_times, retention_indices);

julia&gt; derivmap(mapper, 5.0u&quot;minute&quot;) ≈ 37.42885149584893u&quot;minute^-1&quot;
true

julia&gt; test_times = [3.0, 11.0]u&quot;minute&quot;;

julia&gt; derivmap.(mapper, test_times) ≈ [67.10235298491122, 34.639458067769134]u&quot;minute^-1&quot;
true

julia&gt; derivmap(mapper, 5.0u&quot;minute&quot;, rA_unit=u&quot;s&quot;) ≈ 0.6238141915974822u&quot;s^-1&quot;
true

julia&gt; derivmap(mapper, 0.8u&quot;minute&quot;, warn=true) ≈ 79.01700550402535u&quot;minute^-1&quot;
[ Info: rA=0.8 is below the spline domain boundary (rA_min=1.2): extrapolating left.
true</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/oniehuis/JuChrom.jl/blob/dae4d2fb13e7d05a1fb199b701e38bb500504479/src/core/retention_mapping/map.jl#L630-L699">source</a></section></details></article><article><details class="docstring" open="true"><summary id="JuChrom.fitmap"><a class="docstring-binding" href="#JuChrom.fitmap"><code>JuChrom.fitmap</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">fitmap(retentions_A::AbstractVector{&lt;:Union{&lt;:Real, &lt;:AbstractQuantity{&lt;:Real}}},
       retentions_B::AbstractVector{&lt;:Union{&lt;:Real, &lt;:AbstractQuantity{&lt;:Real}}};
       smoothness_penalty_n::Integer=100,
       monotonicity_grid_size::Integer=10^5,
       λ_max::Real=1e2,
       λ_min::Real=1e-20,
       logλ_tolerance::Real=1e-4,
       max_lambda_iters::Integer=100,
       extras::AbstractDict{&lt;:AbstractString, &lt;:Any}=Dict{String, Any}(),
       optimizer_factory=HiGHS.Optimizer)</code></pre><p>Constructs a strictly increasing, smooth cubic B-spline that maps values from domain A  (<code>retentions_A</code>) to domain B (<code>retentions_B</code>), subject to a monotonicity constraint and  smoothness penalty.</p><p>The fitted spline minimizes a regularized least-squares objective: data fidelity (squared residuals) and a smoothness penalty (second derivative norm), subject to non-negativity of the first derivative.</p><p>The smoothing parameter <code>λ</code> is automatically determined via binary search: it selects the  smallest value that yields a monotonic spline while fitting the data as closely as possible,  thus ensuring both stability and high fidelity without introducing spurious oscillations.</p><p>Inputs are monotonic <code>retentions_A</code>/<code>retentions_B</code> vectors (unitful or unitless), optional controls for smoothness (<code>smoothness_penalty_n</code>, <code>λ_min</code>, <code>λ_max</code>, <code>max_lambda_iters</code>) and monotonicity enforcement (<code>monotonicity_grid_size</code>), optional metadata (<code>extras</code>), and an optimizer constructor. <code>logλ_tolerance</code> is the stopping tolerance on <code>log10(λ)</code> used by the binary search that tunes the smoothing parameter: when the log-range width falls below this value, the search stops (smaller values mean tighter λ tuning at higher cost).</p><p>Returns a <code>RetentionMapper</code> containing the fitted spline and metadata.</p><p>See also  <a href="#JuChrom.AbstractRetentionMapper"><code>AbstractRetentionMapper</code></a>,  <a href="#JuChrom.RetentionMapper"><code>RetentionMapper</code></a>,  <a href="#JuChrom.applymap"><code>applymap</code></a>, <a href="#JuChrom.derivinvmap"><code>derivinvmap</code></a>, <a href="#JuChrom.derivmap"><code>derivmap</code></a>, <a href="#JuChrom.extras-Tuple{JuChrom.AbstractRetentionMapper}"><code>extras</code></a>, <a href="#JuChrom.fitmap"><code>fitmap</code></a>, <a href="#JuChrom.invmap"><code>invmap</code></a>, <a href="#JuChrom.invmapmax"><code>invmapmax</code></a>, <a href="#JuChrom.invmapmin"><code>invmapmin</code></a>, <a href="#JuChrom.mapmax"><code>mapmax</code></a>, <a href="#JuChrom.mapmin"><code>mapmin</code></a>, <a href="#JuChrom.rawapplymap"><code>rawapplymap</code></a>, <a href="#JuChrom.rawderivinvmap"><code>rawderivinvmap</code></a>, <a href="#JuChrom.rawderivmap"><code>rawderivmap</code></a>, <a href="#JuChrom.rawinvmap"><code>rawinvmap</code></a>, <a href="#JuChrom.rawinvmapmax"><code>rawinvmapmax</code></a>, <a href="#JuChrom.rawinvmapmin"><code>rawinvmapmin</code></a>, <a href="#JuChrom.rawmapmax"><code>rawmapmax</code></a>, <a href="#JuChrom.rawmapmin"><code>rawmapmin</code></a>, <a href="#JuChrom.rawretentions_A"><code>rawretentions_A</code></a>,  <a href="#JuChrom.rawretentions_B"><code>rawretentions_B</code></a>,  <a href="#JuChrom.retentions_A"><code>retentions_A</code></a>,  <a href="#JuChrom.retentions_B"><code>retentions_B</code></a>,  <a href="#JuChrom.retentionunit_A"><code>retentionunit_A</code></a>,  <a href="#JuChrom.retentionunit_B"><code>retentionunit_B</code></a>. </p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; retention_times = [1.2, 2.5, 4.1, 6.8, 9.3, 12.1, 15.7]u&quot;minute&quot;
       retention_indices = [100.0, 200.0, 300.0, 400.0, 500.0, 600.0, 700.0];

julia&gt; mapper = fitmap(retention_times, retention_indices, 
                      extras=Dict(&quot;instrument&quot; =&gt; &quot;GC-MS&quot;, &quot;column&quot; =&gt; &quot;DB-5&quot;));

julia&gt; applymap(mapper, 5.0u&quot;minute&quot;) ≈ 338.71144090340465
true

julia&gt; invmap(mapper, 150) ≈ 1.8368240074613091u&quot;minute&quot;
true</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/oniehuis/JuChrom.jl/blob/dae4d2fb13e7d05a1fb199b701e38bb500504479/src/core/retention_mapping/fit.jl#L4-L79">source</a></section></details></article><article><details class="docstring" open="true"><summary id="JuChrom.invmap"><a class="docstring-binding" href="#JuChrom.invmap"><code>JuChrom.invmap</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">invmap(
    rm::RetentionMapper,
    retention::Union{&lt;:Real, &lt;:AbstractQuantity{&lt;:Real}};
    domain_boundary_threshold::Real=1e-8,
    unit::Union{Nothing, Unitful.Units}=retentionunit_A(rm),
    tol::Real=1e-8,
    warn::Bool=false
)</code></pre><p>Invert the fitted mapping by computing the input value (domain A) corresponding to a given  output value (domain B).</p><p>Inputs are a fitted <code>rm</code>, an output value in domain B, an optional <code>unit</code> for output  conversion, <code>tol</code> for root-finding (absolute bisection tolerance when solving the inverse;  smaller values increase accuracy at higher cost), and <code>warn</code> to log extrapolation messages.</p><p>The inversion normalizes the input to the spline domain, extrapolates linearly using the boundary derivative, uses bisection within the domain, and returns the result on the original domain A scale with requested units.</p><p>This function leverages the strict monotonicity of the fitted spline to provide reliable  inverse mapping, enabling bidirectional conversion between the two domains.</p><p>See also <a href="#JuChrom.AbstractRetentionMapper"><code>AbstractRetentionMapper</code></a>,  <a href="#JuChrom.RetentionMapper"><code>RetentionMapper</code></a>, <a href="#JuChrom.applymap"><code>applymap</code></a>, <a href="#JuChrom.derivinvmap"><code>derivinvmap</code></a>, <a href="#JuChrom.derivmap"><code>derivmap</code></a>, <a href="#JuChrom.fitmap"><code>fitmap</code></a>, <a href="#JuChrom.invmapmax"><code>invmapmax</code></a>, <a href="#JuChrom.invmapmin"><code>invmapmin</code></a>, <a href="#JuChrom.mapmax"><code>mapmax</code></a>, <a href="#JuChrom.mapmin"><code>mapmin</code></a>, <a href="#JuChrom.rawapplymap"><code>rawapplymap</code></a>, <a href="#JuChrom.rawderivinvmap"><code>rawderivinvmap</code></a>, <a href="#JuChrom.rawderivmap"><code>rawderivmap</code></a>, <a href="#JuChrom.rawinvmap"><code>rawinvmap</code></a>, <a href="#JuChrom.rawinvmapmax"><code>rawinvmapmax</code></a>, <a href="#JuChrom.rawinvmapmin"><code>rawinvmapmin</code></a>, <a href="#JuChrom.rawmapmax"><code>rawmapmax</code></a>, <a href="#JuChrom.rawmapmin"><code>rawmapmin</code></a>, <a href="#JuChrom.retentionunit_A"><code>retentionunit_A</code></a>,  <a href="#JuChrom.retentionunit_B"><code>retentionunit_B</code></a>.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; retention_times = [1.2, 2.5, 4.1, 6.8, 9.3, 12.1, 15.7]u&quot;minute&quot;
       retention_indices = [100.0, 200.0, 300.0, 400.0, 500.0, 600.0, 700.0]u&quot;Th&quot;
       mapper = fitmap(retention_times, retention_indices);

julia&gt; invmap(mapper, 350.0u&quot;Th&quot;) ≈ 5.312425320906996u&quot;minute&quot;
true

julia&gt; invmap(mapper, 350.0)
ERROR: ArgumentError: Input must have units when rm.rB_unit is a Unitful unit. Expected units compatible with Th.
[...]

julia&gt; test_indices = [250.0u&quot;Th&quot;, 450.0u&quot;Th&quot;];

julia&gt; invmap.(mapper, test_indices) ≈ [3.2283166885897936, 8.08686182716771]u&quot;minute&quot;
true

julia&gt; invmap(mapper, 400.0u&quot;Th&quot;, unit=u&quot;s&quot;) ≈ 407.99982102982375u&quot;s&quot;
true

julia&gt; invmap(mapper, 50.0u&quot;Th&quot;, warn=true) ≈ 0.5672238965934812u&quot;minute&quot;
[ Info: rB=50.0 is below the inverse spline domain boundary (rB_min=100.000073): extrapolating left.
true</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/oniehuis/JuChrom.jl/blob/dae4d2fb13e7d05a1fb199b701e38bb500504479/src/core/retention_mapping/map.jl#L804-L875">source</a></section></details></article><article><details class="docstring" open="true"><summary id="JuChrom.rawapplymap"><a class="docstring-binding" href="#JuChrom.rawapplymap"><code>JuChrom.rawapplymap</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">rawapplymap(
    rm::RetentionMapper,
    retention::Union{&lt;:Real, &lt;:AbstractQuantity{&lt;:Real}};
    domain_boundary_threshold::Real=1e-8,
    unit::Union{&lt;:Nothing, Unitful.Units}=retentionunit_B(rm),
    warn::Bool=false
)</code></pre><p>Apply the fitted mapping to transform an input value from domain A to domain B using the fitted spline within the <code>RetentionMapper</code>, returning a unitless numeric result.</p><p>Inputs are a fitted <code>rm</code>, a unitful retention value, <code>warn</code> for extrapolation logs, and <code>unit</code> for output conversion before stripping.</p><p>The input is normalized before spline evaluation. Out-of-domain values are extrapolated linearly using the boundary slope, and the result is returned as a unitless number in the requested unit system. This method requires unitful input (use <a href="#JuChrom.applymap"><code>applymap</code></a> for unitless inputs).</p><p>This function provides the same transformation as <a href="#JuChrom.applymap"><code>applymap</code></a> but strips units from  the result, which is useful for downstream calculations that require raw numeric values.</p><p>See also <a href="#JuChrom.AbstractRetentionMapper"><code>AbstractRetentionMapper</code></a>,  <a href="#JuChrom.RetentionMapper"><code>RetentionMapper</code></a>, <a href="#JuChrom.applymap"><code>applymap</code></a>, <a href="#JuChrom.derivinvmap"><code>derivinvmap</code></a>, <a href="#JuChrom.derivmap"><code>derivmap</code></a>, <a href="#JuChrom.fitmap"><code>fitmap</code></a>, <a href="#JuChrom.invmap"><code>invmap</code></a>, <a href="#JuChrom.invmapmax"><code>invmapmax</code></a>, <a href="#JuChrom.invmapmin"><code>invmapmin</code></a>, <a href="#JuChrom.mapmax"><code>mapmax</code></a>, <a href="#JuChrom.mapmin"><code>mapmin</code></a>, <a href="#JuChrom.rawderivinvmap"><code>rawderivinvmap</code></a>, <a href="#JuChrom.rawderivmap"><code>rawderivmap</code></a>, <a href="#JuChrom.rawinvmap"><code>rawinvmap</code></a>, <a href="#JuChrom.rawinvmapmax"><code>rawinvmapmax</code></a>, <a href="#JuChrom.rawinvmapmin"><code>rawinvmapmin</code></a>, <a href="#JuChrom.rawmapmax"><code>rawmapmax</code></a>, <a href="#JuChrom.rawmapmin"><code>rawmapmin</code></a>, <a href="#JuChrom.retentionunit_A"><code>retentionunit_A</code></a>,  <a href="#JuChrom.retentionunit_B"><code>retentionunit_B</code></a>.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; retention_times = [1.2, 2.5, 4.1, 6.8, 9.3, 12.1, 15.7]u&quot;minute&quot;
       retention_indices = [100.0, 200.0, 300.0, 400.0, 500.0, 600.0, 700.0]u&quot;Th&quot;
       mapper = fitmap(retention_times, retention_indices);

julia&gt; rawapplymap(mapper, 5.0u&quot;minute&quot;) ≈ 338.71144090340465
true

julia&gt; test_times = [3.0, 11.0]u&quot;minute&quot;;

julia&gt; rawapplymap.(mapper, test_times) ≈ [235.0195638002354, 564.0302630521933]
true

julia&gt; rawapplymap(mapper, 0.5u&quot;minute&quot;, warn=true) ≈ 44.68816899287087
[ Info: rA=0.5 is below the spline domain boundary (rA_min=1.2): extrapolating left.
true</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/oniehuis/JuChrom.jl/blob/dae4d2fb13e7d05a1fb199b701e38bb500504479/src/core/retention_mapping/map.jl#L1196-L1259">source</a></section></details></article><article><details class="docstring" open="true"><summary id="JuChrom.rawderivinvmap"><a class="docstring-binding" href="#JuChrom.rawderivinvmap"><code>JuChrom.rawderivinvmap</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">rawderivinvmap(
    rm::RetentionMapper,
    retention::Union{&lt;:Real, &lt;:AbstractQuantity{&lt;:Real}};
    domain_boundary_threshold::Real=1e-8,
    rA_unit::Union{Nothing, Unitful.Units}=retentionunit_A(rm),
    rB_unit::Union{Nothing, Unitful.Units}=retentionunit_B(rm),
    tol::Real=1e-8, 
    warn::Bool=false
)</code></pre><p>Compute the derivative of the inverse mapping, i.e. d(A)/d(B), at a given output value  (domain B), returning a unitless numeric result.</p><p>This function computes the local derivative <code>d(A)/d(B)</code> at a given output value using  the inverse of the normalized B-spline approximation stored in the <code>RetentionMapper</code>.  This derivative describes how a small change in the output (domain B) would translate  back to a change in the input (domain A), under the smoothed, monotonic mapping. If the  output value is outside the supported domain, extrapolation is performed using the boundary  derivative. The derivative is adjusted to account for the normalization scales applied  during spline fitting.</p><p>Inputs are a fitted <code>rm</code>, an output value in domain B, optional <code>rA_unit</code>/<code>rB_unit</code> for  unit conversion, and <code>tol</code> for root-finding (absolute bisection tolerance when solving the  inverse; smaller values increase accuracy at higher cost). <code>domain_boundary_threshold</code> sets  how far beyond the normalized inverse spline domain a value must lie before logging an extrapolation warning when <code>warn=true</code>.</p><p>Returns the derivative d(A)/d(B) as a unitless number in the <code>rA_unit/rB_unit</code> system before stripping. This is the reciprocal of <a href="#JuChrom.rawderivmap"><code>rawderivmap</code></a>, is always positive under the monotonic constraint, and uses root-finding to locate the corresponding input value. Out-of-domain values use the boundary derivative.</p><p>This function provides the same transformation as <a href="#JuChrom.derivinvmap"><code>derivinvmap</code></a> but strips units  from the result, which is useful for downstream calculations that require raw numeric  values.</p><p>See also <a href="#JuChrom.AbstractRetentionMapper"><code>AbstractRetentionMapper</code></a>,  <a href="#JuChrom.RetentionMapper"><code>RetentionMapper</code></a>, <a href="#JuChrom.applymap"><code>applymap</code></a>, <a href="#JuChrom.derivinvmap"><code>derivinvmap</code></a>, <a href="#JuChrom.derivmap"><code>derivmap</code></a>, <a href="#JuChrom.fitmap"><code>fitmap</code></a>, <a href="#JuChrom.invmap"><code>invmap</code></a>, <a href="#JuChrom.invmapmax"><code>invmapmax</code></a>, <a href="#JuChrom.invmapmin"><code>invmapmin</code></a>, <a href="#JuChrom.mapmax"><code>mapmax</code></a>, <a href="#JuChrom.mapmin"><code>mapmin</code></a>, <a href="#JuChrom.rawapplymap"><code>rawapplymap</code></a>, <a href="#JuChrom.rawderivmap"><code>rawderivmap</code></a>, <a href="#JuChrom.rawinvmap"><code>rawinvmap</code></a>, <a href="#JuChrom.rawinvmapmax"><code>rawinvmapmax</code></a>, <a href="#JuChrom.rawinvmapmin"><code>rawinvmapmin</code></a>, <a href="#JuChrom.rawmapmax"><code>rawmapmax</code></a>, <a href="#JuChrom.rawmapmin"><code>rawmapmin</code></a>, <a href="#JuChrom.retentionunit_A"><code>retentionunit_A</code></a>,  <a href="#JuChrom.retentionunit_B"><code>retentionunit_B</code></a>.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; retention_times = [1.2, 2.5, 4.1, 6.8, 9.3, 12.1, 15.7]u&quot;minute&quot;
       retention_indices = [100.0, 200.0, 300.0, 400.0, 500.0, 600.0, 700.0]u&quot;Th&quot;
       mapper = fitmap(retention_times, retention_indices);

julia&gt; rawderivinvmap(mapper, 350.0u&quot;Th&quot;) ≈ 0.02857099580171666
true

julia&gt; rawderivinvmap(mapper, 350.0)
ERROR: ArgumentError: Input must have units when rm.rB_unit is a Unitful unit. Expected units compatible with Th.
[...]

julia&gt; test_indices = [250.0, 600.0]u&quot;Th&quot;;

julia&gt; rawderivinvmap.(mapper, test_indices) ≈ [0.015606366497378708, 0.03240806524912834]
true

julia&gt; rawderivinvmap(mapper, 350.0u&quot;Th&quot;, rA_unit=u&quot;s&quot;) ≈ 1.7142597481029995
true

julia&gt; rawderivinvmap(mapper, 50.0u&quot;Th&quot;, warn=true) ≈ 0.012655503630152843
[ Info: rB=50.0 is below the inverse spline domain boundary (rB_min=100.000073): extrapolating left.
true

julia&gt; retention_times = [1.2, 2.5, 4.1, 6.8, 9.3, 12.1, 15.7]u&quot;minute&quot;
       retention_indices = [100.0, 200.0, 300.0, 400.0, 500.0, 600.0, 700.0]
       mapper = fitmap(retention_times, retention_indices);

julia&gt; rawderivinvmap(mapper, 350.0) ≈ 0.02857099580171666
true

julia&gt; rawderivinvmap(mapper, 350.0u&quot;Th&quot;)
ERROR: ArgumentError: Input cannot have units when rm.rB_unit is Nothing. Expected unitless input.
[...]</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/oniehuis/JuChrom.jl/blob/dae4d2fb13e7d05a1fb199b701e38bb500504479/src/core/retention_mapping/map.jl#L1284-L1379">source</a></section></details></article><article><details class="docstring" open="true"><summary id="JuChrom.rawderivmap"><a class="docstring-binding" href="#JuChrom.rawderivmap"><code>JuChrom.rawderivmap</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">rawderivmap(
    rm::RetentionMapper,
    retention::AbstractQuantity{&lt;:Real};
    domain_boundary_threshold::Real=1e-8,
    rA_unit::Union{Nothing, Unitful.Units}=retentionunit_A(rm), 
    rB_unit::Union{Nothing, Unitful.Units}=retentionunit_B(rm), 
    warn::Bool=false
)</code></pre><p>Compute the first derivative of the fitted mapping with respect to the input (domain A) at a given input value, returning a unitless numeric result.</p><p>This function evaluates the derivative of the fitted monotonic B-spline, extrapolating using boundary derivatives if the input lies outside the spline domain. The derivative is adjusted to account for the normalization scales applied during spline fitting.</p><p>Inputs are a fitted <code>rm</code>, a unitful input value in domain A, optional <code>rA_unit</code>/<code>rB_unit</code> for unit conversion, and <code>warn</code> to log extrapolation messages. <code>domain_boundary_threshold</code> sets how far beyond the normalized spline domain a value must lie before logging an extrapolation warning when <code>warn=true</code>.</p><p>Returns the derivative d(B)/d(A) as a unitless number in the <code>rB_unit/rA_unit</code> system before stripping. This method requires unitful input (use <a href="#JuChrom.derivmap"><code>derivmap</code></a> for unitless inputs). The derivative is always positive under the monotonic constraint, and extrapolation uses constant boundary derivatives outside the fitted domain.</p><p>This function provides the same transformation as <a href="#JuChrom.derivmap"><code>derivmap</code></a> but strips units from  the result, which is useful for downstream calculations that require raw numeric values.</p><p>See also  <a href="#JuChrom.AbstractRetentionMapper"><code>AbstractRetentionMapper</code></a>,  <a href="#JuChrom.RetentionMapper"><code>RetentionMapper</code></a>, <a href="#JuChrom.applymap"><code>applymap</code></a>, <a href="#JuChrom.derivinvmap"><code>derivinvmap</code></a>, <a href="#JuChrom.derivmap"><code>derivmap</code></a>, <a href="#JuChrom.fitmap"><code>fitmap</code></a>, <a href="#JuChrom.invmap"><code>invmap</code></a>, <a href="#JuChrom.invmapmax"><code>invmapmax</code></a>, <a href="#JuChrom.invmapmin"><code>invmapmin</code></a>, <a href="#JuChrom.mapmax"><code>mapmax</code></a>, <a href="#JuChrom.mapmin"><code>mapmin</code></a>, <a href="#JuChrom.rawapplymap"><code>rawapplymap</code></a>, <a href="#JuChrom.rawderivinvmap"><code>rawderivinvmap</code></a>, <a href="#JuChrom.rawinvmap"><code>rawinvmap</code></a>, <a href="#JuChrom.rawinvmapmax"><code>rawinvmapmax</code></a>, <a href="#JuChrom.rawinvmapmin"><code>rawinvmapmin</code></a>, <a href="#JuChrom.rawmapmax"><code>rawmapmax</code></a>, <a href="#JuChrom.rawmapmin"><code>rawmapmin</code></a>, <a href="#JuChrom.retentionunit_A"><code>retentionunit_A</code></a>,  <a href="#JuChrom.retentionunit_B"><code>retentionunit_B</code></a>.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; retention_times = [1.2, 2.5, 4.1, 6.8, 9.3, 12.1, 15.7]u&quot;minute&quot;
       retention_indices = [100.0, 200.0, 300.0, 400.0, 500.0, 600.0, 700.0]
       mapper = fitmap(retention_times, retention_indices);

julia&gt; rawderivmap(mapper, 5.0u&quot;minute&quot;) ≈ 37.42885149584893
true

julia&gt; test_times = [3.0, 11.0]u&quot;minute&quot;;

julia&gt; rawderivmap.(mapper, test_times) ≈ [67.10235298491122, 34.639458067769134]
true

julia&gt; rawderivmap(mapper, 5.0u&quot;minute&quot;, rA_unit=u&quot;s&quot;) ≈ 0.6238141915974822
true

julia&gt; rawderivmap(mapper, 0.8u&quot;minute&quot;, warn=true) ≈ 79.01700550402535
[ Info: rA=0.8 is below the spline domain boundary (rA_min=1.2): extrapolating left.
true</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/oniehuis/JuChrom.jl/blob/dae4d2fb13e7d05a1fb199b701e38bb500504479/src/core/retention_mapping/map.jl#L1434-L1507">source</a></section></details></article><article><details class="docstring" open="true"><summary id="JuChrom.rawinvmap"><a class="docstring-binding" href="#JuChrom.rawinvmap"><code>JuChrom.rawinvmap</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">rawinvmap(
    rm::RetentionMapper, 
    retention::Union{&lt;:Real, &lt;:AbstractQuantity{&lt;:Real}};
    domain_boundary_threshold::Real=1e-8, 
    unit::Union{Nothing, Unitful.Units}=retentionunit_A(rm), 
    tol::Real=1e-8,
    warn::Bool=false
)</code></pre><p>Invert the fitted mapping by computing the input value (domain A) corresponding to a given  output value (domain B), returning a unitless numeric result.</p><p>Inputs are a fitted <code>rm</code>, a unitful output value in domain B, an optional <code>unit</code> for conversion before stripping, <code>tol</code> for root-finding (absolute bisection tolerance when  solving the inverse; smaller values increase accuracy at higher cost), and <code>warn</code> to log  extrapolation messages.</p><p>The inversion normalizes the input to the spline domain, extrapolates linearly using the boundary derivative, uses bisection within the domain, and returns a unitless result in the requested unit system. This method requires unitful input (use <a href="#JuChrom.invmap"><code>invmap</code></a> for unitless inputs).</p><p>This function leverages the strict monotonicity of the fitted spline to provide reliable  inverse mapping, enabling bidirectional conversion between the two domains while returning raw numeric values useful for downstream calculations.</p><p>See also <a href="#JuChrom.AbstractRetentionMapper"><code>AbstractRetentionMapper</code></a>,  <a href="#JuChrom.RetentionMapper"><code>RetentionMapper</code></a>, <a href="#JuChrom.applymap"><code>applymap</code></a>, <a href="#JuChrom.derivinvmap"><code>derivinvmap</code></a>, <a href="#JuChrom.derivmap"><code>derivmap</code></a>, <a href="#JuChrom.fitmap"><code>fitmap</code></a>, <a href="#JuChrom.invmap"><code>invmap</code></a>, <a href="#JuChrom.invmapmax"><code>invmapmax</code></a>, <a href="#JuChrom.invmapmin"><code>invmapmin</code></a>, <a href="#JuChrom.mapmax"><code>mapmax</code></a>, <a href="#JuChrom.mapmin"><code>mapmin</code></a>, <a href="#JuChrom.rawapplymap"><code>rawapplymap</code></a>, <a href="#JuChrom.rawderivinvmap"><code>rawderivinvmap</code></a>, <a href="#JuChrom.rawderivmap"><code>rawderivmap</code></a>, <a href="#JuChrom.rawinvmapmax"><code>rawinvmapmax</code></a>, <a href="#JuChrom.rawinvmapmin"><code>rawinvmapmin</code></a>, <a href="#JuChrom.rawmapmax"><code>rawmapmax</code></a>, <a href="#JuChrom.rawmapmin"><code>rawmapmin</code></a>, <a href="#JuChrom.retentionunit_A"><code>retentionunit_A</code></a>,  <a href="#JuChrom.retentionunit_B"><code>retentionunit_B</code></a>.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; retention_times = [1.2, 2.5, 4.1, 6.8, 9.3, 12.1, 15.7]u&quot;minute&quot;
       retention_indices = [100.0, 200.0, 300.0, 400.0, 500.0, 600.0, 700.0]u&quot;Th&quot;
       mapper = fitmap(retention_times, retention_indices);

julia&gt; rawinvmap(mapper, 350.0u&quot;Th&quot;) ≈ 5.312425320906996
true

julia&gt; rawinvmap(mapper, 350.0) ≈ 5.312425320906996
ERROR: ArgumentError: Input must have units when rm.rB_unit is a Unitful unit. Expected units compatible with Th.
[...]

julia&gt; test_indices = [250.0, 450.0]u&quot;Th&quot;;

julia&gt; rawinvmap.(mapper, test_indices) ≈ [3.2283166885897936, 8.08686182716771]
true

julia&gt; rawinvmap(mapper, 400.0u&quot;Th&quot;, unit=u&quot;s&quot;) ≈ 407.99982102982375
true

julia&gt; rawinvmap(mapper, 50.0u&quot;Th&quot;, warn=true) ≈ 0.5672238965934812
[ Info: rB=50.0 is below the inverse spline domain boundary (rB_min=100.000073): extrapolating left.
true

julia&gt; retention_times = [1.2, 2.5, 4.1, 6.8, 9.3, 12.1, 15.7]u&quot;minute&quot;
       retention_indices = [100.0, 200.0, 300.0, 400.0, 500.0, 600.0, 700.0]
       mapper = fitmap(retention_times, retention_indices);

julia&gt; rawinvmap(mapper, 350.0) ≈ 5.312425320906996
true

julia&gt; rawinvmap(mapper, 350.0u&quot;Th&quot;) ≈ 5.312425320906996
ERROR: ArgumentError: Input cannot have units when rm.rB_unit is Nothing. Expected unitless input.
[...]</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/oniehuis/JuChrom.jl/blob/dae4d2fb13e7d05a1fb199b701e38bb500504479/src/core/retention_mapping/map.jl#L1560-L1645">source</a></section></details></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../mapping_overview/">« Overview</a><a class="docs-footer-nextpage" href="../mz_binning/">m/z binning »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Thursday 15 January 2026 10:15">Thursday 15 January 2026</span>. Using Julia version 1.12.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
